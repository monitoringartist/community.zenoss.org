<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:clearspace="http://www.jivesoftware.com/xmlns/clearspace/rss" xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0">
  <channel>
    <title>Wiki : HOW TO CONFIGURE WMI ACCESS ON WINDOWS FOR A NON ADMIN USER : Comments</title>
    <link>http://community.zenoss.org/docs/DOC-4517#comments</link>
    <description>Comments on : HOW TO CONFIGURE WMI ACCESS ON WINDOWS FOR A NON ADMIN USER</description>
    <language>en</language>
    <pubDate>Tue, 22 Dec 2009 13:28:15 GMT</pubDate>
    <generator>Jive SBS 4.5.6.2  (http://jivesoftware.com/products/clearspace/)</generator>
    <dc:date>2009-12-22T13:28:15Z</dc:date>
    <dc:language>en</dc:language>
    <item>
      <title>RE: HOW TO CONFIGURE WMI ACCESS ON WINDOWS FOR A NON ADMIN USER</title>
      <link>http://community.zenoss.org/docs/DOC-4517#comments-1618</link>
      <description>&lt;!-- [DocumentBodyStart:7a266adc-ccb1-4036-a77c-3615e0f8469b] --&gt;&lt;div class="jive-rendered-content"&gt;&lt;pre&gt;&lt;br/&gt;&lt;/pre&gt;&lt;p&gt;This is an excellent write-up. As someone not-at-all-skilled in the mysteries of Windows, some of the commands are pure magic. I implemented this in a test environment with a local (non-Domain) Windows user called zenwmi on a Windows 2003 machine with SP2 applied. Extra comments I would add for those who are not very Windows-literate:&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;1) Having created the zenwmi user, make sure that the user does not have to change password and that the password doesn't expire.&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;2) Add the zenwmi user to the built-in Distributed COM Users group&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;3) In section 2 when giving Enable Account and Remote Enable privilege to the zenwmi user, follow the Microsoft link provided.&lt;br/&gt;"WMI Control" can be accessed either from a command prompt via wmimgmt.msc or from the menus, choose Administrative Tools -&amp;gt; Computer Management -&amp;gt; Services &amp;amp; Applications -&amp;gt; WMI - use the right mouse button and slect Properties. Make sure you give the 2 documented permissions to the CIMV2 class - giving them for root does not help you!&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;4) In the last 2 steps, there is some magic gobbledegook that includes the string&lt;br/&gt;S-1-5-21-1248577188-10479689-3873521419-99999 - this is actually the SID of your zenwmi user and needs to match your environment. I had no idea how to find the SID but Google came up with a little visual basic script as follows:&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;strComputer = "."&lt;br/&gt;Set objWMIService = GetObject("winmgmts:\\" &amp;amp; strComputer &amp;amp; "\root\cimv2")&lt;br/&gt;Set objAccount = objWMIService.Get _&lt;br/&gt;("Win32_UserAccount.Name='zenwmi',Domain='WIN2003'")&lt;br/&gt;Wscript.Echo objAccount.SID&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;You replace the account name of zenwmi if you are using a different user and the Domain is your domain name or computer name if you are not using a domain.&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;5) In section 4, I again followed the Microsoft link to modify Local policy. The instructions worked fine. When you get to the part about "Use the Local Group Policy to set your ... Security", in step 2 you want the "Windows Settings" under the "Local Computer Policy" (there was another "Windows Settings" tree somewhere).&lt;br/&gt;The other crucial part is that the Microsoft site only talks about the Application and System logs - for Zenoss to work, you must make the modifications for ALL the logs that the Windows system supports - otherwise you will get some of the error messages documented in the excellent debugging section in this document. Use the Windows Event Viewer to see what logs you have. I had an extra "Internet Explorer" log as well as the Security log so created extra entries for both. Here are my extra lines in sceregvl.inf (they should be 2 lines):&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;MACHINE\System\CurrentControlSet\Services\Eventlog\Security\CustomSD,1,%SecLogSD%,2&lt;br/&gt;MACHINE\System\CurrentControlSet\Services\Eventlog\Internet Explorer\CustomSD,1,%IELogSD%,2&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;and (again it should be 2 lines)&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;SecLogSD="Event log: Specify the security of the security log in Security Descriptor Definition Language (SDDL) syntax"&lt;br/&gt;IELogSD="Event log: Specify the security of the IE log in Security Descriptor Definition Language (SDDL) syntax"&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;When you get to setting the security policy, the magic string in this document worked fine but do remember to replace the SID with your zenwmi SID.&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;I needed most of the debugging help at the end of this document because of the mistakes I had made and they worked every time!&lt;br/&gt;There is a small typo in the debugging section to do with SCM permissions.&amp;#160; The debugging command should be:&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;sc sdshow scmanager&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;Great document! Many thanks.&lt;/p&gt;&lt;p style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p&gt;Cheers,&lt;/p&gt;&lt;p&gt;Jane&lt;/p&gt;&lt;/div&gt;&lt;!-- [DocumentBodyEnd:7a266adc-ccb1-4036-a77c-3615e0f8469b] --&gt;</description>
      <pubDate>Tue, 22 Dec 2009 13:00:56 GMT</pubDate>
      <author>community@zenoss.org</author>
      <guid>http://community.zenoss.org/docs/DOC-4517#comments-1618</guid>
      <dc:date>2009-12-22T13:00:56Z</dc:date>
      <clearspace:dateToText>4 years, 2 months ago</clearspace:dateToText>
      <clearspace:objectType>0</clearspace:objectType>
    </item>
    <item>
      <title>RE: HOW TO CONFIGURE WMI ACCESS ON WINDOWS FOR A NON ADMIN USER</title>
      <link>http://community.zenoss.org/docs/DOC-4517#comments-6612</link>
      <description>&lt;!-- [DocumentBodyStart:38946e48-6b7e-4865-8a32-d1efd629438b] --&gt;&lt;div class="jive-rendered-content"&gt;&lt;p class="p1"&gt;Thank you for this awesome tutorial&amp;amp;howto. As an option for the mentioned vb script you can also run&lt;/p&gt;&lt;p class="p1" style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p class="p2" style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p class="p1"&gt;&lt;em&gt;get the sid of a specific user via WMI query - wmic /namespace:\\root\cimv2 path win32_useraccount where "name='zenwin'" get name, sid&lt;/em&gt;&lt;/p&gt;&lt;p class="p3" style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p class="p1"&gt;on one of your domain controllers. Replacing &lt;em&gt;'zenwin'&lt;/em&gt; with the name of your user account.&lt;/p&gt;&lt;p class="p3" style="min-height: 8pt; height: 8pt; padding: 0px;"&gt;&amp;#160;&lt;/p&gt;&lt;p class="p1"&gt;Regards,&lt;/p&gt;&lt;p class="p1"&gt;Tobias&lt;/p&gt;&lt;/div&gt;&lt;!-- [DocumentBodyEnd:38946e48-6b7e-4865-8a32-d1efd629438b] --&gt;</description>
      <pubDate>Tue, 28 May 2013 18:16:48 GMT</pubDate>
      <author>community@zenoss.org</author>
      <guid>http://community.zenoss.org/docs/DOC-4517#comments-6612</guid>
      <dc:date>2013-05-28T18:16:48Z</dc:date>
      <clearspace:dateToText>9 months, 2 weeks ago</clearspace:dateToText>
      <clearspace:objectType>0</clearspace:objectType>
    </item>
  </channel>
</rss>

