<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>
        13.6 Other Customizations - Open Source Network Monitoring and Systems Management
        
        
    </title>

    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="en-US" />
<meta name="keywords" content=""/>
<!-- 13.6 Other Customizations -->
<meta property="og:image" content="servlet/JiveServlet/downloadImage/73-2574-13230/share-zenoss-logo.jpg" />

<link rel="search"
    href="../opensearch.xml"
    title="Zenoss Community"
    type="application/opensearchdescription+xml"/>


<link rel="shortcut icon" href="../themes/userbar-disabled/images/favicon.ico" />

    





    
      
      
     




    



    
    





    <link rel="stylesheet" href="../styles/jive-global.css" type="text/css" media="all" />
    <!-- <link rel="stylesheet" href="/styles/jive-icons-legacy.css" type="text/css" media="all" /> -->
    <link rel="stylesheet" href="../styles/jive-icons.css" type="text/css" media="all" />

    <link rel="stylesheet" href="../themes/userbar-disabled/styles/theme.css" type="text/css" media="all" />
    <link rel="stylesheet" href="../themes/userbar-disabled/styles/community.css" type="text/css" media="all" />
    <link rel="stylesheet" href="../themes/userbar-disabled/styles/sifr.css" type="text/css" media="all" />


    <!--[if IE 6]>
    <style type="text/css">
    /* hack for IE6's lack of alpha PNG support */
    * html #jive-wrapper .ie6png,
    * html #jive-wrapper #jive-global-header *.ie6png,
    * html #jive-wrapper #user-bar-wrapper *.ie6png,
    * html #jive-wrapper #jive-body *.ie6png,
    * html #jive-wrapper #jive-footer *.ie6png {
        background-image: expression(
        this.runtimeStyle.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src=" +
        (this.tagName=='IMG' ? this.src : this.currentStyle.backgroundImage.split('\"')[1]) + ")",
        this.runtimeStyle.backgroundImage = "none",
        this.src = "/images/transparent.png"
        );
        }
    </style>

    <link rel="stylesheet" href="/styles/jive-icons-ie.css" type="text/css" media="all" />
    <![endif]-->





    
    

	<link rel="stylesheet" href="../4.5.6/styles/jive-content.css" type="text/css" media="all" />

        <link rel="alternate" type="application/rss+xml"
            title="13.6 Other Customizations Version History Feed"
            href="../community/feeds/document-history/DOC-10099" />

        <link rel="alternate" type="application/rss+xml"
            title="13.6 Other Customizations Comments Feed"
            href="../community/feeds/document-comments/DOC-10099" />

    
        




    <!-- BEGIN action bar, only for non-binary documents -->

    

    <!-- END action bar -->




    <style type="text/css">/* Rating bar on documents */
.jive-content .jive-content-header .jive-content-rating {margin-bottom: 3px;}
.j-rating { padding: 0 10px; }
.jive-content-avgrating {height: 53px;}
/* END Rating bar on documents */

/* Userbar */
#jive-userbar-right {right: 50px;}
/* END Userbar */

/* Download links page */
table.download-links-table {background-color: #ffffff; width: 100%;}
table.download-links-table tbody td { text-align: center; vertical-align: middle;}
table.download-links-table thead th {text-align: center;}
table.download-links-table td, table.download-links-table th {border: 1px solid #EEEEEE !important;}

/* Provides indentation for official doc ToC items */
div.toc dl dt {margin-left: 20px;}
div.toc dl dd dl dt {margin-left: 40px;}
div.toc dl dd dl dd dl dt {margin-left: 60px;}
div.toc dl dd dl dd dl dd dl dt {margin-left: 80px;}
div.toc dl dd dl dd dl dd dl dd dl dt {margin-left: 100px;}
/* END docs items */


/* Blog posts */
div.social-button-spacer {height: 10px;}

div#social-button-cont {
margin-right:10px; 
padding:5px; 
text-align: center; 
float: right;
}

div#comment-indicator {
    float: left;
    left: 12px;
    right: inherit;
    top: 55px;
}

div#comment-indicator div.jive-reply {margin-left: 0px;}

.jive-blog-post-subject {padding-bottom: 0px;}
/* END Blog posts */


/* Community download survey */
form#core-usage-survey label.aligned {float: left; width: 120px;}
form#core-usage-survey span.required_field {color: red;}
form#core-usage-survey label.survey-small-label {display:inline;}
form#core-usage-survey div.survey-checkbox-set {width:82%;}
form#core-usage-survey div.border {border:1px solid #ACACAC; padding:5px;}

form#core-usage-survey label.survey-resource_type {font-style:italic;}
form#core-usage-survey label {
color:#333333;
display:block;
font-size:12px;
font-weight:bold;
}
/* END Community download survey */

</style>
    <style type="text/css">/* custom-css-container */</style>


</head>
<body class="jive-body-home" ><div style="width:100%;background-color:white;float:left;position:fixed;z-index:3000;top:0;right:0;border-bottom:2px solid gray;"><div style="width:1006px;font-weight:bold;margin:12px auto 12px auto;font-size:18px;"><div style="float: left; margin: 0;">Archived community.zenoss.org | full text search <form style="display: inline;" target="_blank" action="https://github.com/monitoringartist/community.zenoss.org/search" method="get"><input type="text" name="q"><input type="submit" value="Search"></form> </div><div style="float: right;"><a href="https://www.monitoringartist.com" title="Maintained by Monitoring Artist - DevOps / Docker / Kubernetes / Zabbix / Zenoss / Monitoring"><img src="/community.zenoss.org/assests-monitoringartist/Monitoring-Artist-logo.png" /></a></div></div></div>


<a href="DOC-10099.html#jive-body" class="jive-skip-nav">Skip navigation</a>

    <div id="jive-compliance" class=""style="display:none">
        <span class="jive-icon-med "></span>
        
    </div>

    <div id="jive-wrapper" class="clearfix">

    <!-- Load search for guests -->

    <div id="jive-userbar-search">
    <form action="search.jspa" method="get" id="jive-userbar-search-form">
        <input type="hidden" name="peopleEnabled" value="true"/>

        <input type="hidden" name="userID"/>
        <input type="hidden" name="containerType"/>
        <input type="hidden" name="container"/>
        <input type="hidden" name="spotlight" value="false"/>
        <label for="jive-query"
               class="j-508-label">Search for:</label>
        <input type="text" id="jive-query" name="q" value="" accesskey="4" class="searchbar jive-userbar-search-field"
               autocomplete="off"/>
    </form>

    <div id="jive-spotlight-search-container"></div>
</div>

    <!-- END anon search -->

<!-- SKIP NAV FOR ACCESSIBILITY -->
<a href="DOC-10099.html#skipnav"></a>
<!-- END -->

<div id="header">

    <!-- START TOP NAVIGATION -->
    <div id="navcontainer">
        <table cellpadding="0" cellspacing="0" width="100%" border="0">
          <tr valign="bottom">
            <td rowspan="2">
                <a href="../index.html" title="Zenoss Open Source IT Management"><img src="../themes/userbar-disabled/images/zenoss-logo-reversed-web.png" style="width:254px; margin: 0 0px 25px;" alt="Zenoss Open Enterprise Management" /></a>
            </td>
            <td height="45" colspan="2">
                <div id="zenoss-panel">
                    <div style="width: 200px;" id="cpanel-lt"></div>
                    <ul id="subnav-rt" class="png_fix">
                        <li><a href="http://www.zenoss.com/" title="Zenoss.Inc Home" class="none">Zenoss, Inc.</a></li>
                        <!--<li><a href="/community/feedback" title="Feedback" class="none">Feedback</a></li>-->
                        <!--<li><a href="http://www.zenoss.com/support" title="Support" class="none">Support</a></li>-->
                    </ul>
                </div>
            </td>
          </tr>
          <tr valign="middle">
            <td colspan="2" height="80">
                <ul id="navlist">
                    <li><a href="community/documentation" title="DOCS" class="nav1"><span>DOCS</span></a></li>
                    <li><a href="community/forums" title="FORUMS" class="nav2"><span>FORUMS</span></a></li>        
                    <!--<li><a href="/community/zenpacks" title="ZENPACKS" class="nav3"><span>ZENPACKS</span></a></li>-->
                    <li><a href="http://wiki.zenoss.org/Category:ZenPacks" title="ZENPACKS" class="nav3"><span>ZENPACKS</span></a></li>        
                    <li><a href="community/partners" title="PARTNERS" class="nav4"><span>PARTNERS</span></a></li>      
                    <li><a href="community/about" title="ABOUT" class="nav4"><span>ABOUT</span></a></li>   
                    <li><a href="../blogs/zenossblog.html" title="BLOG" class="nav5"><span>BLOG</span></a></li>
                    <li><a href="community/testing" title="TESTING" class="nav5"><span>TESTING</span></a></li> 
                    <li><a href="community/developers" title="DEVELOPERS" class="nav6"><span>DEVELOPMENT</span></a></li>
                    <li><a href="../community/download.html" title="DOWNLOADS" class="nav7 png_fix"><span>DOWNLOAD</span></a></li>
                </ul>
            </td>
          </tr>
        </table>
    </div>
    <!-- END TOP NAV -->

</div>

<!-- START MID COL -->
<div id="middle">

    <!-- SKIPNAV ADDED FOR ACCESSIBILITY -->
    <a name="skipnav"></a>
    <!-- SKIPNAV END -->
        
      <!-- START CONTENT -->
      
        <!-- MAIN CONTENT START -->
        <!-- CHANGE CLASS ACCORDING TO SUB SECTION FOR PROPER TOP BANNER -->


        <div id="subcontent">




<!-- BEGIN user bar -->
<div id="user-bar-wrapper">
    <div id="jive-userbar">
<div id="jive-userbar-login">
    <form action="https://community.zenoss.org/cs_login"
          method="post" name="loginform" autocomplete="off">
        
        

        <span class="jive-userbar-login-welcome" id="jiveLoginWelcome">
            <span class="jive-userbar-login-guest">
            Welcome, Guest
            </span>

            <span class="jive-userbar-login-loginlink">
                <a href="DOC-10099.html#" onClick="jivetoggleLogin(); return false;">Login</a>
            </span>

            <span class="jive-userbar-login-new">
                <a href="../login!input.jspa%3FregisterOnly=true.html">Register</a>
            </span>
        </span>

        <span class="jive-userbar-login-form" id="jiveLoginForm" style="display: none;">

            <span class="jive-userbar-login-username">
                <label for="login-username">
Username:                </label>
                <a href="docs/forgot-username!input.jspa" title="I forgot my username ">(?)</a>
                <input type="text" name="username" size="20" maxlength="150" value="" tabindex="1"
                               id="login-username" />
            </span>

            <span class="jive-userbar-login-password">
                <label for="login-password">
Password:                </label>
                <a href="docs/emailPasswordToken!input.jspa" title="I forgot my password ">(?)</a>
                <input type="password" name="password" size="20" maxlength="150" value="" tabindex="2"
                               id="login-password" />
            </span>

            <span class="jive-userbar-login-auto">
                <input type="checkbox" name="autoLogin" id="login-auto" value="true" tabindex="3" />
                <label for="login-auto">Remember Me</label>
            </span>

            <span class="jive-userbar-login-submit">
                <input type="submit" name="login" value="Login" tabindex="4"
                       class="jive-login-button" />
                <input type="reset" name="doCancel" value="Cancel" tabindex="5"
                               class="jive-cancel-button" onclick="jivetoggleLogin();" />
            </span>
        </span>

    </form>
</div>        <div id="jive-userbar-right">

    <div id="jive-userbar-search">
    <form action="search.jspa" method="get" id="jive-userbar-search-form">
        <input type="hidden" name="peopleEnabled" value="true"/>

        <input type="hidden" name="userID"/>
        <input type="hidden" name="containerType"/>
        <input type="hidden" name="container"/>
        <input type="hidden" name="spotlight" value="false"/>
        <label for="jive-query"
               class="j-508-label">Search for:</label>
        <input type="text" id="jive-query" name="q" value="" accesskey="4" class="searchbar jive-userbar-search-field"
               autocomplete="off"/>
    </form>

    <div id="jive-spotlight-search-container"></div>
</div>

        </div>
    </div>

</div>
<!-- END user bar -->

            <div id="jive-body">

<!-- BEGIN breadcrumb -->
<div id="jive-breadcrumb">

    <span>
                <a href="../index.jspa.html">
            Zenoss Community</a> &gt; 
                <a href="community/documentation">
            Documentation</a> &gt; 
                <a href="community/documentation/official_documentation">
            Zenoss Core Product Documentation</a> &gt; 
                <a href="community/documentation/official_documentation/zenoss-dev-guide">
            Zenoss Developer's Guide</a> &gt; 
                <a href="community/documentation/official_documentation/zenoss-dev-guide/3.0v01">
            3.0v01</a> &gt; 

        <a class='jive-breadcrumb-last' href="community/documentation/official_documentation/zenoss-dev-guide/3.0v01?view=documents">Documents</a></span>
</div>
<!-- END breadcrumb -->

            

    <form id="documentRestoreForm" method="post" action='docs/DOC-10099/restore'>
        <input type="hidden" name="version" value="3" />
        <input type="hidden" name="jive.token.name" value="document.restore.DOC-10099"/>
        <input type="hidden" name="document.restore.DOC-10099" value="1394833688178-AMT3YDWN2ZOPWYBX8FQHOAINLX4BPGDS"/>
    </form>

    <form id="documentDeleteForm" method="post" action='docs/DOC-10099/delete'>
        <input type="hidden" name="jive.token.name" value="document.delete.DOC-10099"/>
        <input type="hidden" name="document.delete.DOC-10099" value="1394833688184-MKCLUJNAFNHG5LC0OES7600U7HRN5832"/>
    </form>

    <form id="documentPublishForm" method="post" action='doc-publish.jspa'>
        <input type="hidden" name="jive.token.name" value="document.publish.DOC-10099"/>
        <input type="hidden" name="document.publish.DOC-10099" value="1394833688190-KH5L6HALH6RGRRT1CIGFLSPIHDD1LJUJ"/>
        <input type="hidden" name="document" value="DOC-10099" />
    </form>


    <!-- BEGIN header & intro  -->
    <div id="jive-body-intro">
        <div id="jive-body-intro-content">
            
            <a href="community/documentation/official_documentation/zenoss-dev-guide/3.0v01?view=documents"><span class="jive-icon-sml jive-icon-arrow-generic-up"></span>
                    Up to Documents in 3.0v01
            </a>

        </div>
    </div>
    <!-- END header & intro -->

    <!-- BEGIN main body -->
    <div id="jive-body-main">

        <!-- BEGIN main body column -->
        <div id="jive-body-maincol-container">

            <div id="jive-body-maincol">


                <div id="thread.watch.notify" class="jive-info-box" style="display:none"></div>

                <div id="content-featured-notify" class="jive-info-box" style="display:none"></div>








<!-- BEGIN document -->
<div class="jive-content clearfix">
    <div class="jive-content-header clearfix">
        <div class="jive-wiki-post-moderating jive-content-header-moderating">
            <span class="jive-icon-med jive-icon-moderation"></span>Currently Being Moderated
        </div>
        <div class="jive-content-title">
            <h2><span class="jive-icon-big jive-icon-document"></span>13.6 Other Customizations</h2>
        </div>
        <div class="jive-content-header-version">
            VERSION 3&nbsp;
                <a href="docs/DOC-10099/diff?secondVersionNumber=3" title="Click to view document history"><img class="jive-icon-sml jive-icon-search" src="../4.5.6/images/transparent.png" alt="Click to view document history" /></a>


        </div>
        <div class="jive-content-header-details">

Created on: Oct 28, 2010 1:58 PM by
<a href="../people/zenoss_api.html"
data-externalId=""
data-username="zenoss_api"
data-avatarId="-1"
id="jive-692632885091268730248"
onmouseover="var presence = null; quickuserprofile.getUserProfileTooltip( 6926, presence );"
onmouseout="quickuserprofile.cancelTooltip();"
class="jiveTT-hover-user jive-username-link"
>Zenoss API</a>            <span>-</span>
Last Modified:&nbsp;
Oct 28, 2010 2:05 PM
by <a href="../people/zenoss_api.html"
data-externalId=""
data-username="zenoss_api"
data-avatarId="-1"
id="jive-692632885091269285748"
onmouseover="var presence = null; quickuserprofile.getUserProfileTooltip( 6926, presence );"
onmouseout="quickuserprofile.cancelTooltip();"
class="jiveTT-hover-user jive-username-link"
>Zenoss API</a>        </div>

        <div class="jive-content-rating clearfix" data-guid="8FYH8RD6LVSPFEK2LBBUGB5D36AHZMXW">

<script type='text/javascript'>
    $j(document).ready(function() {

        var i18n = {
            avgUserRatingTitlei18n : "Average User Rating",
            avgUserRatingLabeli18n : "Average User Rating",
            rateRatingLabel : "rating",
            myRatingLabel : "My Rating:",
            rateRatingsLabel : "ratings",
            ratingSavingText : "Saving...",
            rateSavedText : "Saved.",
            rateRatingSaved : "Rating Saved!",
            writeAReview : "Write a review",
            commentOnRating : "Comment on your rating",
            formSubmitPleaseWait:'Please Wait ...'
        };

        new jive.Rate(14, 2266, 102, 10099, 'doc', i18n, true, '8FYH8RD6LVSPFEK2LBBUGB5D36AHZMXW');
    });

</script>

        </div>
    </div>

    <div class="jive-content-body">


<!-- [DocumentBodyStart:0a166374-5752-4d61-a9f8-b4d9a5d8d00e] --><div class="jive-rendered-content"><div class="navheader"><table summary="Navigation header" width="100%"><tr><th align="center" colspan="3" style=";">6.&#160;Other Customizations</th></tr><tr><td align="left" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/ch13s05.html">Prev</a>&#160;</td><th align="center" style=";" width="60%">Chapter&#160;13.&#160;Extending the User Interface</th><td align="right" style=";" width="20%">&#160;<a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/ch13s07.html">Next</a></td></tr></table><hr/></div><div class="section" title="6.&#160;Other Customizations"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a class="jive-link-anchor-small" name="ui_general_customizations">&#160;</a>6.&#160;Other Customizations</h2></div></div></div><p>Some of these options may be deprecated or provide altered functionality in Zenoss 3.0. See the chapter titled "ZenPack Conversion Tasks for 3.0" for additional compatibility information.</p><div class="section" title="6.1.&#160;Adding Tabs"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="d0e7159">&#160;</a>6.1.&#160;Adding Tabs</h3></div></div></div><p>This section will show how to add a new tab in Zenoss (prior to Version 3.0) or add a selection to the <span class="inlinemediaobject"><a href="../servlet/JiveServlet/showImage/102-10099-3-6228/Action_Menu.png"><img class="jive-image" height="24" src="../servlet/JiveServlet/downloadImage/102-10099-3-6228/34-24/Action_Menu.png" width="34"/></a></span> (Action menu) (Version 3.0 or later), or modify an existing one by means of a ZenPack or <span class="command"><strong>zendmd</strong></span>.</p><p>A tab in Zenoss is an object property that resides within the following structure:</p><pre class="programlisting">&#160;&#160;&#160; factory_type_information = (
&#160;&#160;&#160;&#160;&#160;&#160;&#160; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'immediate_view' : 'deviceOrganizerStatus',
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'actions'&#160;&#160;&#160;&#160;&#160;&#160;&#160; :
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; { 'id'&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 'status'
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; , 'name'&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 'Status'
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; , 'action'&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 'deviceOrganizerStatus'
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; , 'permissions'&#160;&#160; : (permissions.view,)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; },
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; )
&#160;&#160;&#160;&#160;&#160;&#160;&#160; },
&#160;&#160;&#160; )</pre><p>For example, tabs in the <code class="filename">Locations</code> screen are created from the Python class definition </p><pre class="programlisting">Location(DeviceOrganizer, ZenPackable)</pre><p> which resides in the module <code class="filename">Location.py</code> in the <code class="filename">$ZENPATH/Products/ZenModel</code> directory.</p><p>Zenoss works with class instances which are created runtime by Zope. These objects are packed within database which is called ZODB. If you want to modify some object properties you should connect to ZODB and get the object first, modify it and save your changes.</p><p>The following example shows the procedure for adding a new tab to Locations screen. This code is executed from <code class="filename">__init__.py</code> of an example ZenPack.</p><pre class="programlisting">import Globals
import transaction
import os.path

skinsDir = os.path.join(os.path.dirname(__file__), 'skins')
from Products.CMFCore.DirectoryView import registerDirectory
if os.path.isdir(skinsDir):
&#160;&#160;&#160; registerDirectory(skinsDir, globals())

from AccessControl import Permissions as permissions
from Products.ZenModel.ZenPack import ZenPackBase
from Products.ZenUtils.Utils import zenPath
from Products.ZenModel.ZenossSecurity import *
from Products.ZenUtils.ZenScriptBase import ZenScriptBase

class ZenPack(ZenPackBase):
&#160;&#160;&#160; olMapTab = { 'id'&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 'olgeomaptab'
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; , 'name'&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 'OpenLayers Map'
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; , 'action'&#160;&#160;&#160;&#160;&#160;&#160;&#160; : 'OLGeoMapTab'
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; , 'permissions'&#160;&#160; : (permissions.view,)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }

&#160;&#160;&#160; def _registerOLMapTab(self, app):
&#160;&#160;&#160;&#160;&#160;&#160;&#160; # Register new tab in locations
&#160;&#160;&#160;&#160;&#160;&#160;&#160; dmdloc = self.getDmdRoot('Locations')
&#160;&#160;&#160;&#160;&#160;&#160;&#160; finfo = dmdloc.factory_type_information
&#160;&#160;&#160;&#160;&#160;&#160;&#160; actions = list(finfo[0]['actions'])
&#160;&#160;&#160;&#160;&#160;&#160;&#160; for i in range(len(actions)):
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if(self.olMapTab['id'] in actions[i].values()):
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return
&#160;&#160;&#160;&#160;&#160;&#160;&#160; actions.append(self.olMapTab)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; finfo[0]['actions'] = tuple(actions)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; dmdloc.factory_type_information = finfo
&#160;&#160;&#160;&#160;&#160;&#160;&#160; transaction.commit()

&#160;&#160;&#160; def _unregisterOLMapTab(self, app):
&#160;&#160;&#160;&#160;&#160;&#160;&#160; dmdloc = self.getDmdRoot('Locations')
&#160;&#160;&#160;&#160;&#160;&#160;&#160; finfo = dmdloc.factory_type_information
&#160;&#160;&#160;&#160;&#160;&#160;&#160; actions = list(finfo[0]['actions'])
&#160;&#160;&#160;&#160;&#160;&#160;&#160; for i in range(len(actions)):
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if(self.olMapTab['id'] in actions[i].values()):
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; actions.remove(actions[i])
&#160;&#160;&#160;&#160;&#160;&#160;&#160; finfo[0]['actions'] = tuple(actions)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; dmdloc.factory_type_information = finfo
&#160;&#160;&#160;&#160;&#160;&#160;&#160; transaction.commit()

&#160;&#160;&#160; def install(self, app):
&#160;&#160;&#160;&#160;&#160;&#160;&#160; ZenPackBase.install(self, app)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; self._registerOLMapTab(app)

&#160;&#160;&#160; def upgrade(self, app):
&#160;&#160;&#160;&#160;&#160;&#160;&#160; ZenPackBase.upgrade(self, app)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; self._registerOLMapTab(app)

&#160;&#160;&#160; def remove(self, app, junk):
&#160;&#160;&#160;&#160;&#160;&#160;&#160; ZenPackBase.remove(self, app, junk)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; zpm = app.zport.ZenPortletManager
&#160;&#160;&#160;&#160;&#160;&#160;&#160; self._unregisterOLMapTab(app)
</pre><p>The class method <code class="function">_registerOLMapTab(self, app)</code> registers the modified property of object <code class="filename">Locations</code> , which resides in <code class="filename">/zport/dmd/Locations</code> in the ZODB.</p><p>The function <code class="function">getDmdRoot('Locations')</code> returns the class instance of class <code class="classname">Location</code> which is in ZopeDB. Next we get the dictionary of its <span class="property">factory_type_information</span> property. Modify this, so that a new dictionary defining the tab is appended to it. The tab structure is defined in <span class="property">olMapTab</span> dictionary. The <span class="property">id</span> field is the identification name of this tab. You can put any string here. The <span class="property">name</span> field is the string that is shown on your new tab, <span class="property">action</span> points to the template that is executed when you click on the tab and should be accessible in Zope. The <span class="property">permissions</span> field is default permissions for zenoss user to execute the template this tab points to. This line <code class="code">dmdloc.factory_type_information = finfo</code> is very important because Zope won't detect any change to the persistent object and <code class="function">transaction.commit()</code> won't save any modifications to the object. The rule here is that <code class="function">commit()</code> saves only modifications of object that executes its <code class="function">setattr()</code> method.</p><p>Of course every step shown above can be done manually within the <span class="command"><strong>zendmd</strong></span> prompt. The following session shows adding new tab to <code class="filename">Locations</code> in <span class="command"><strong>zendmd</strong></span>:</p><pre class="programlisting">zenoss@db-server:/home/geonick$ zendmd
Welcome to zenoss dmd command shell!
use zhelp() to list commands
&gt;&gt;&gt; from AccessControl import Permissions as permissions
&gt;&gt;&gt; locobj = dmd.getDmdRoot('Locations')
&gt;&gt;&gt; locobj
&lt;Location at /zport/dmd/Locations&gt;
&gt;&gt;&gt; finfo = locobj.factory_type_information
&gt;&gt;&gt; finfo
({'immediate_view': 'deviceOrganizerStatus', 
'actions': ({'action': 'deviceOrganizerStatus',
'id': 'status', 'name': 'Status', 'permissions': ('View',)}, 
{'action': 'viewEvents', 'id': 'events',
'name': 'Events', 'permissions': ('View',)}, 
{'action': 'deviceOrganizerManage', 'id': 'manage', 'name'
: 'Administration', 'permissions': ('Manage DMD',)}, 
{'action': 'locationGeoMap', 'id': 'geomap', 'name
: 'Map', 'permissions': ('View',)})},)
&gt;&gt;&gt; actions = list(finfo[0]['actions'])
&gt;&gt;&gt; olMapTab = {'id': 'olgeomaptab', 'name': 'OpenLayers Map', 
'action': 'OLGeoMapTab','permissions': (permissions.view,)}
&gt;&gt;&gt; for i in range(len(actions)):
...&#160;&#160;&#160;&#160; if(olMapTab['id'] in actions[i].values()):
...&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; break
...
&gt;&gt;&gt; actions.append(olMapTab)
&gt;&gt;&gt; finfo[0]['actions'] = tuple(actions)
&gt;&gt;&gt; locobj.factory_type_information = finfo
&gt;&gt;&gt; locobj.factory_type_information
({'immediate_view': 'deviceOrganizerStatus', 'actions': (
{'action': 'deviceOrganizerStatus',
'id': 'status', 'name': 'Status', 'permissions': ('View',)}, 
{'action': 'viewEvents',
'id': 'events', 'name': 'Events', 'permissions': ('View',)}, 
{'action': 'deviceOrganizerManage',
'id': 'manage', 'name': 'Administration', 'permissions': ('Manage DMD',)}, 
{'action': 'locationGeoMap',
'id': 'geomap', 'name': 'Map', 'permissions': ('View',)}, 
{'action': 'OLGeoMapTab', 'permissions': ('View',),
'id': 'olgeomaptab', 'name': 'OpenLayers Map'})},)
&gt;&gt;&gt;commit()
</pre><p>After <code class="function">commit()</code> the new tab should be in Locations. Don't forget to provide the template file.</p><p>(<span class="emphasis"><em>Submitted by Nikolai Georgiev</em></span>)</p></div><div class="section" title="6.2.&#160;Adding a Dialog"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="ui_add_dialog">&#160;</a>6.2.&#160;Adding a Dialog</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title">Note</h3><p>This procedure is valid for pre-3.0 versions only.</p></div><p>The dialog container exists on every page in Zenoss; it's a <span class="property">DIV</span> element with the <span class="property">id</span> attribute of <span class="property">dialog</span>. Loading a dialog performs two actions:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Fetching (via an XHR) HTML to display inside the dialog container</p></li><li class="listitem"><p>Showing the dialog container. These can be accomplished by calling the <code class="function">show()</code> method on the dialog container, passing the event and an URL that will return the contents:</p><pre class="programlisting">&#160;&#160;&#160; $('dialog').show(this.event, 'dialog_MyDialog')</pre><p>The dialog can then be hidden with, predictably, $('dialog').hide(). Since dialogs are almost always loaded via clicking on a menu item, menu items whose <span class="property">isdialog</span> attribute is <code class="constant">True</code> will generate the JavaScript to show the dialog automatically. See the <a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/ch13s06.html#ui_adding_menu">Section&#160;6.3, &ldquo;Adding a New Menu or Menu Item&#8221;</a> section of this guide for more information.'</p></li></ol></div><p>As for the dialog box contents themselves, any valid HTML will do, but certain conventions exist. Dialogs should have a header:</p><pre class="programlisting">&#160;&#160;&#160;&#160;&#160; &lt;h2&gt;Perform Action&lt;/h2&gt;</pre><p>Dialogs should also provide a cancel button:</p><pre class="programlisting">&#160;&#160;&#160; &lt;input id="dialog_cancel" type="button" value="Cancel"
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; onclick="$('dialog').hide()"/&gt;</pre><p>The main wrinkle with dialogs occurs in the area of form submission. Some dialogs are self-contained, and can carry their own form that is created and submitted just like any other form. Other dialogs, however, submit forms that exist elsewhere on the page -- for example, dialogs that perform actions against multiple rows checked in a table. These dialogs may use the submit_form method on the dialog container, which submits the form surrounding the menu item that caused the dialog to be loaded to the url passed in to the method. Thus for a table surrounded by a &lt;form&gt; and containing several checkboxes, dialogs loaded by menu items in the table's menu may submit the table's form to a url by providing a button:</p><pre class="programlisting">&#160;&#160;&#160; &lt;input type="submit" name="doAction:method" value="Do It"
&#160;&#160;&#160;&#160;&#160;&#160;&#160; tal:attributes="onclick string:
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; $('dialog').submit_form('${here/absolute_url_path}')"/&gt;</pre><p>See the section on <a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/ch13s01.html#ui_about_zope_zpt_tal">Section&#160;1.3, &ldquo;Zope 2, ZPT and TAL&#8221;</a> for more information about <span class="property">tal:attributes</span> and the <code class="code">${here/absolute_url_path}</code> syntax.</p><p>Finally, dialogs that create objects should validate the desired id before submitting. A method on the dialog container called <code class="function">submit_form_and_check()</code>, which accepts the same parameters as <code class="function">submit_form()</code> (URL), will do this. It requires:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>A text box with the id 'new_id', the value of which will be checked</p></li><li class="listitem"><p>A hidden input field with the id <span class="property">checkValidIdPath</span>, with a value containing the path in which the id should be valid (for example, creating a device under <code class="filename">/zport/dmd/Devices</code> will require checking that no other devices in <code class="filename">/zport/dmd/Devices</code> has the same id, so the value of <span class="property">checkValidIdPath</span> should be "<code class="filename">/zport/dmd/Devices</code>". <code class="function">here/getPrimaryUrlPath</code> works well for most cases).</p></li><li class="listitem"><p>An element with the id <span class="property">errmsg</span> into which the error message from the validation method, if any, will be put</p></li></ol></div><p>For example, a generic object creation dialog:</p><pre class="programlisting">&#160;&#160;&#160; &lt;h2&gt;Create Object&lt;/h2&gt;
&#160;&#160;&#160; &lt;span id="errmsg" style="color:red;"&gt;&lt;/span&gt;
&#160;&#160;&#160; &lt;br/&gt;
&#160;&#160;&#160; &lt;span&gt;ID: &lt;/span&gt;
&#160;&#160;&#160; &lt;input id="new_id" name="id"/&gt;
&#160;&#160;&#160; &lt;input type="hidden" id="checkValidIdPath"
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tal:attributes="value here/getPrimaryUrlPath"/&gt;
&#160;&#160;&#160; &lt;br/&gt;
&#160;&#160;&#160; &lt;input tal:attributes="onclick string:
&#160;&#160;&#160;&#160;&#160;&#160;&#160; return $$('dialog').submit_form_and_check('${here/getPrimaryUrlPath}')"
&#160;&#160;&#160;&#160;&#160;&#160;&#160; id="dialog_submit"
&#160;&#160;&#160;&#160;&#160;&#160;&#160; type="submit"
&#160;&#160;&#160;&#160;&#160;&#160;&#160; value="Create"
&#160;&#160;&#160;&#160;&#160;&#160;&#160; name="createObject:method"/&gt;
&#160;&#160;&#160; &lt;input id="dialog_cancel" type="button" value="Cancel"
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; onclick="$('dialog').hide()"/&gt;
</pre><p>These examples will cover most cases; generally, a good idea is to look at other dialog templates that contain similar elements or perform similar actions.</p></div><div class="section" title="6.3.&#160;Adding a New Menu or Menu Item"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="ui_adding_menu">&#160;</a>6.3.&#160;Adding a New Menu or Menu Item</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title">Note</h3><p>This procedure is valid for pre-3.0 versions only.</p></div><p>Classes that inherit from the ZenMenuable mixin have a method called getMenus, which traverses up the object's path aggregating <code class="classname">ZenMenuItem</code> objects owned by its ancestors. These objects comprise an action to be executed, a human-readable description, and various attributes restricting the objects to which the item is applicable.</p><p>For example, imagine basic menus exist on <code class="varname">dmd</code> and <code class="varname">dmd.Devices</code>:</p><pre class="screen">&#160;&#160;&#160; dmd
&#160;&#160;&#160;&#160;&#160;&#160;&#160; More&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (menu)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; See more...&#160;&#160; (menu item)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Do more...
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Manage
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Manage object...
&#160;&#160;&#160; dmd.Devices
&#160;&#160;&#160;&#160;&#160;&#160;&#160; More
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; See more...
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Do less...</pre><p>A call to <code class="function">dmd.Devices.getMenus()</code> will return:</p><pre class="screen">&#160;&#160;&#160; More
&#160;&#160;&#160;&#160;&#160;&#160;&#160; See more...&#160;&#160;&#160;&#160;&#160; (from dmd.Devices)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Do more...&#160;&#160;&#160;&#160;&#160;&#160; (from dmd)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Do less...&#160;&#160;&#160;&#160;&#160;&#160; (from dmd.Devices)
&#160;&#160;&#160; Manage
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Manage object... (from dmd)</pre><p>As you can see, menu items inherit their ancestors' unless they define their own, which override when their ancestors' conflict.</p><p>In theory, all <code class="classname">ZenMenuables</code> (which includes nearly all objects in Zenoss) may own menu items; in practice, all but a few menus live on /zport/dmd.</p><p>Adding a new menu item is fairly straightforward. Because menu items are persistent objects, modifications must happen in a migrate script (or be included as XML in a ZenPack). The method <code class="function">ZenMenuable.buildMenus()</code> accepts a dictionary of menus, each of which is a list of dictionaries representing the attributes of menu items. Instructions on writing migrate scripts can be found elsewhere in this guide.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Find the id of the menu to which you wish to add items. The simplest way to do this is to locate the <span class="property">menu_ids</span> definition on the page template that renders the menu. Tables will have a single menu id. The page menu may have several, which will be rendered as sub-menus. The <span class="property">TopLevel</span> menu is a special case; it appears in the page menu, but its items are rendered as siblings of the other menus.</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">&#160;</p></li><li class="listitem"><p>If activating the menu item will require a dialog, create one. See the <a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/ch13s06.html#ui_add_dialog">Section&#160;6.2, &ldquo;Adding a Dialog&#8221;</a> section of this guide for more info.</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">&#160;</p></li><li class="listitem"><p>Determine the objects for which the menu item should be visible. Menu items will use several criteria for determining whether to apply:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>allowed_classes: A list of strings of class names for which the menu item should be rendered.</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">&#160;</p></li><li class="listitem"><p>banned_classes: A list of strings of class names for which the menu item should not be rendered.</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">&#160;</p></li><li class="listitem"><p>banned_ids: A list of strings of object ids for which the menu item should not be rendered.</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">&#160;</p></li><li class="listitem"><p>isglobal: Whether the menu item should be inherited by children of the menu item's owner.</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">&#160;</p></li><li class="listitem"><p>permissions: The permissions the current user must have for the context in order for the item to render.</p></li></ul></div></li><li class="listitem"><p>Figure out the action the menu item will perform. If it's a dialog, then the action is the name of the dialog template, and the <span class="property">isdialog</span> attribute of the menu item should be <code class="constant">True</code>. If it's a regular link, the action should be the URL or "javascript:" you would normally have as the <span class="property">href</span> attribute of an anchor.</p><p style="min-height: 8pt; height: 8pt; padding: 0px;">&#160;</p></li><li class="listitem"><p>Now build the dictionary. It should look like this, where <span class="property">MenuId</span> is the menu from step 1:</p><pre class="programlisting">&#160;&#160;&#160; menus = { 'MenuId': [
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; { 'id': 'myUniqueId',
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'description': 'Perform My Action...',
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'action': 'dialog_myAction',
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'isdialog': True,
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'allowed_classes': ('MyGoodClass',),
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'banned_classes': ('MyBadClass',),
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'banned_ids': ('Devices',),
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'ordering': 50.0,
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 'permissions': (ZenossSecurity.ZEN_COMMON,)
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; },
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ]}</pre><p>'ordering' is a float determining the item's relative position in the menu. Greater numbers mean the item will be placed higher. Also notice that it's almost certainly pointless to set both <span class="property">allowed_classes</span> and <span class="property">banned_classes</span>; it was done here only as an example. The permission <code class="constant">ZEN_COMMON</code> is a standard Zenoss permission -- see the new permissions section of this guide for more information.</p><p>If you have more menu items in the same menu, you can add them to that list; if you have more menus, you can create more keys in the menus dictionary.</p></li><li class="listitem"><p>Finally, use the <code class="function">dmd.buildMenus()</code> method to create the <code class="classname">MenuItems</code>:</p><pre class="programlisting">&#160;&#160;&#160; dmd.buildMenus(menus)</pre></li></ol></div><p style="min-height: 8pt; height: 8pt; padding: 0px;">&#160;</p></div><div class="section" title="6.4.&#160;Creating a Table Using ZenTableManager"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="ui_creating_tables">&#160;</a>6.4.&#160;Creating a Table Using ZenTableManager</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title">Note</h3><p>This procedure is valid for 2.x versions and for re-skinned pages in version 3.x. See the chapter titled "ZenPack Conversion Tasks for 3.0" for additional compatibility information.</p></div><p>ZenTableManager is a Zope product that helps manage and display large sets of tabular data. It allows for column sorting, breaking down the set into pages, and filtering of elements in the table.</p><p>Here's a sample of a table listing all devices under the current object along with their IPs. First we set up the form that will deal with our navigation form elements:</p><pre class="programlisting"> ...
&lt;form method="post" tal:attributes="action here/absolute_url_path" 
&#160;&#160; name="[MYFORM]"&gt;
&lt;script type="text/javascript" 
&#160;&#160;&#160; src="/zport/portal_skins/zenmodel/submitViaEnter.js"&gt;&lt;/script&gt;
</pre><p>Next, we set up our table, defining the objects we want to list (in this case, here/devices/getSubDevicesGen). We then pass those objects, along with a unique tableName, to ZenTableManager, which will return a batch of those objects of the right size (for paging purposes):</p><pre class="programlisting">&#160; &lt;table class="zentable"
tal:define="objects here/devices/getSubDevicesGen;
tableName string:myDeviceTable;
batch python:here.ZenTableManager.getBatch(tableName, objects)"
tal:condition="python:batch or
here.ZenTableManager.getTableState(tableName, 'filter')"&gt;
</pre><p>Next, a table header and a couple of hidden fields:</p><pre class="programlisting"> &lt;tr&gt;
&lt;th class="tabletitle" colspan="2"&gt; &lt;!--Colspan will of course change with the number of fields you show--&gt;
My Devices
&lt;/th&gt;
&lt;/tr&gt;
&lt;input type='hidden' name='tableName' tal:attributes='value tableName' /&gt;
&lt;input type='hidden' name='zenScreenName' tal:attributes='value template/id' /&gt;
</pre><p>Now we add the rows that describe our devices. First we need to set up the column headers so that they'll be clickable for sorting. For that, we use <code class="function">ZenTableManager.getTableHeader(tableName, fieldName, fieldTitle, sortRule="cmp")</code>.</p><pre class="programlisting"> &lt;tbody&gt;
&lt;tr&gt;
&lt;!--We want to sort by names using case-insensitive comparison--&gt;
&lt;th tal:replace="structure python:here.ZenTableManager.getTableHeader(
tableName, 'primarySortKey', 'Name', 'nocase')"&gt;name&lt;/th&gt;
&lt;!--Default sortRule is fine for IP sorting--&gt;
&lt;th tal:replace="structure python:here.ZenTableManager.getTableHeader(
tableName, 'getDeviceIp', 'IP')"&gt;ip&lt;/th&gt;
&lt;/tr&gt;
</pre><p>Now the data themselves. In order to have our rows alternate colors, we'll use the useful TALES attribute <code class="varname">odd</code>, which is True for every other item in a <code class="code">tal:repeat</code> loop.</p><pre class="programlisting"> &lt;tal:block tal:repeat="device batch"&gt;
&lt;tr tal:define="odd repeat/device/odd"
tal:attributes="class python:test(odd, 'odd', 'even')"&gt;
&lt;td class="tablevalues"&gt;
&lt;a class="tablevalues" href="href"
tal:attributes="href device/getDeviceUrl"
tal:content="device/id"&gt;device
&lt;/a&gt;
&lt;/td&gt;
&lt;td class="tablevalues"
tal:content="device/getDeviceIp"&gt;ip&lt;/td&gt;
&lt;/tr&gt;
&lt;/tal:block&gt;
&lt;/tbody&gt; </pre><p>Finally, let's add the navigation tools we need and close off our tags.</p><pre class="programlisting"> &lt;tr&gt;
&lt;td colspan="2" class="tableheader"&gt;
&lt;span metal:use-macro="here/zenTableNavigation/macros/navbodypagedevice" /&gt;
&lt;/td&gt;
&lt;/tr&gt;

&lt;/table&gt;
&lt;/form&gt; </pre></div><div class="section" title="6.5.&#160;Creating an Editable Table"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="ui_creating_editable_tables">&#160;</a>6.5.&#160;Creating an Editable Table</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title">Note</h3><p>This procedure is valid for 2.x versions and for re-skinned pages in version 3.x. See the chapter titled "ZenPack Conversion Tasks for 3.0" for additional compatibility information.</p></div><p>But what if you want to be able to edit devices from this table? The process is simple. First, you add a checkbox to the first column of your device list:</p><pre class="programlisting"> &lt;td class="tablevalues" align="left"&gt;
&lt;!--Now add your checkbox, defining the list of devices as "deviceNames"--&gt;
&lt;input tal:condition="here/editableDeviceList"
type="checkbox" name="deviceNames:list"
tal:attributes="value device/getRelationshipManagerId"/&gt;
&lt;!--Then the first column contents as above--&gt;
&lt;a...&gt;device&lt;/a&gt;
&lt;/td&gt; </pre><p>Now that we can choose devices from the list, we need the controls to edit them. In this case, we'll use a macro defining controls that allow a device to be moved to a different device class. Just add the macro call to the end of your table:</p><pre class="programlisting"> ...
&lt;/tr&gt;
&lt;!--Add controls here--&gt;
&lt;tal:block tal:condition="here/editableDeviceList"
tal:define="numColumns string:5"&gt; &lt;!--This macro includes the &lt;tr&gt; tag, so we need to pass it colspan--&gt;
&lt;span metal:use-macro="here/deviceListMacro/macros/deviceControl" /&gt;
&lt;/tal:block&gt;

&lt;/table&gt;
&lt;/form&gt;
</pre></div><div class="section" title="6.6.&#160;How to Save Properties via an Edit Screen"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="ui_save_properties_using_edit_screen">&#160;</a>6.6.&#160;How to Save Properties via an Edit Screen</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;" title="Note"><h3 class="title">Note</h3><p>This procedure is valid for 2.x versions and for re-skinned pages in version 3.x. See the chapter titled "ZenPack Conversion Tasks for 3.0" for additional compatibility information.</p></div><p>Creating a new Edit Form.</p><p>Add form input fields</p><p>Add a boolean type:</p><pre class="programlisting"> ...
&lt;select class="tablevalues"
tal:attributes="name MyBooleanProperty:boolean"&gt;
&lt;option tal:repeat="boolProp python:(True,False)" tal:content="boolProp"
tal:attributes="value boolProp; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; selected python:boolProp==here.getMyBooleanProperty()"/&gt;
&lt;/select&gt;
...
</pre><p>This block of code creates a select dropdown with two options: <code class="constant">True</code> and <code class="constant">False</code>. The select dropdown is pre-populated with the value returned by <code class="function">getMyBooleanProperty()</code>. The value of this form field will be stored in the attribute <span class="property">MyBooleanProperty</span>.</p><p>Add a text box type:</p><pre class="programlisting"> ...
&lt;textarea class="tablevalues" rows='5' cols="33"
tal:attributes="name MyTextProperty:text"
tal:content="here/getMyTextProperty"&gt;
&lt;/textarea&gt;
...
</pre><p>This block of code creates a text box. The text box is pre-populated with the string value returned by <code class="function">getMyTextBoxProperty()</code>. The value of this form field will be stored in the attribute <span class="property">MyTextBoxProperty</span>.</p><p>Add a text type:</p><pre class="programlisting"> ...
&lt;input class="tablevalues" type="text" size="40"
tal:attributes="value here/getMyStringProperty; name MyStringProperty"/&gt;
...
</pre><p>This block of code creates a text field. The text field is pre-populated with the string value returned by <code class="function">getMyStringProperty()</code>. The value of this form field will be stored in the attribute <span class="property">MyStringProperty</span>.</p><p>Add a select dropdown type:</p><pre class="programlisting"> ...
&lt;select class="tablevalues"
tal:attributes="name MySelectProperty"&gt;
&lt;option tal:repeat="propOption here/getMySelectPropertyOptions"
tal:content="propOption"
tal:attributes="value propOption; 
&#160;&#160;&#160;&#160; selected python:propOption==getMySelectProperty()" /&gt;
&lt;/select&gt;
...
</pre><p>This block of code creates a select dropdown where the option value and displayed option string are the same. A list of option values are returned by <code class="function">getMySelectPropertyOptions</code>. The select dropdown is pre-populated by the value in <span class="property">getMySelectProperty</span>. The value of this form field will be stored in the attribute <span class="property">MySelectProperty</span>.</p><pre class="programlisting"> ...
&lt;select class="tablevalues"
tal:attributes="name MySelectProperty:int"&gt;
&lt;option tal:repeat="propOptionTuple here/getMySelectPropertyOptionTuples"
tal:content="python:propOptionTuple[0]"
tal:attributes="value propOptionTuple[1]; 
&#160;&#160;&#160; selected python:propOptionTuple[1]==getMySelectProperty()" /&gt;
&lt;/select&gt;
...
</pre><p>This block of code creates a select dropdown where the option value is an integer and displayed option is a string. A list of tuples containing the option values and displayed option string are returned by <code class="function">getMySelectPropertyOptionTuples</code>. The select dropdown is pre-populated by the value in <span class="property">getMySelectProperty</span>. The value of this form field will be stored in the attribute <span class="property">MySelectProperty</span>.</p><p>Add the form action</p><pre class="programlisting">
...
&lt;form id='MyForm' method="post" tal:attributes="action here/absolute_url_path"&gt;
...
</pre><p>The form action should be set to a function (i.e. <code class="function">here/absolute_url_path</code>) that returns the path to the object being edited.</p><pre class="programlisting"> ...
&lt;input class="tableheader" type="submit"
name="saveProperties:method" value=" Save " /&gt;
...
</pre><p>This submit button name will be in the format <code class="constant">saveProperties:method</code>. <code class="function">saveProperties</code> is the method name that will be executed when the <span class="guilabel">submit</span> button is clicked.</p><p>Add the <code class="function">save()</code> method</p><pre class="programlisting">...
def saveProperties(self, REQUEST=None):
&#160;&#160;&#160;&#160;&#160;"""Save all Properties found in the REQUEST.form object. """
&#160;&#160;&#160;&#160;&#160;for name, value in REQUEST.form.items():
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;if getattr(self, name, None) != value:
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;self.setProperty(name, value)

&#160;&#160;&#160;&#160;&#160;return self.callZenScreen(REQUEST)
...
</pre><p>Create a <code class="function">saveProperty()</code> method in the effective object.</p></div></div><div class="navfooter"><hr/><table summary="Navigation footer" width="100%"><tr><td align="left" style=";" width="40%"><a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/ch13s05.html">Prev</a>&#160;</td><td align="center" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/ch13.html">Up</a></td><td align="right" style=";" width="40%">&#160;<a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/ch13s07.html">Next</a></td></tr><tr><td align="left" style=";" valign="top" width="40%">5.&#160;Zope 3 Views Explained&#160;</td><td align="center" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-dev-guide/3.0-v01/index.html">Home</a></td><td align="right" style=";" valign="top" width="40%">&#160;7.&#160;Creating a Dashboard Portlet</td></tr></table></div></div><!-- [DocumentBodyEnd:0a166374-5752-4d61-a9f8-b4d9a5d8d00e] -->

<!-- BEGIN attachments -->
<!-- END attachments -->
    </div>
    <div class="jive-content-footer clearfix">


    <!-- BEGIN content details -->
        <span class="jive-content-footer-item jive-content-footer-acclaim">

<div id="acclaim-container-102-10099-" class="acclaim-container">
    <div id="jive-acclaim-like-container-102-10099-" data-uniqueKey="102-10099-" data-ratingType="like" data-hasVoted="false" data-likes="0" class="acclaim-like-container">
         <span class="jive-icon-sml jive-icon-like"></span>Like
         (<a href="DOC-10099.html#" id="jive-acclaim-likedlink-102-10099-"  class=" jive-acclaim-likedlink">0</a>)
    </div>
</div>        </span>

     
        <span class="jive-content-footer-item">
            2466&nbsp;Views
        </span>

        



    <!-- BEGIN view/add/edit tags -->
    <span class="jive-content-footer-item jive-content-footer-tags">
    </span>
    <!-- END view/add/edit tags -->
<!-- END content -->

    </div>
</div>
<!-- END document -->





    
    <script>
    </script>






    <link rel="stylesheet" type="text/css" href="../4.5.6/styles/tiny_mce3/plugins/inlinepopups/skins/clearlooks2/window.css" />




    




        <a name="comments"></a>

        <!-- BEGIN tabs -->
        <div class="jive-body-tabbar">

                <span id="jive-comments-tab" class="jive-body-tab jive-body-tabcurrent">
                    <strong class="font-color-normal">
                        Comments (<span id="jive-comments-count">0</span>)
                    </strong>
                </span>

        </div>
        <!-- END tabs -->

            <div class="jive-box clearfix" id="jive-comments" ></div>

        <div style="display:none;" id="jive-comment-post-block">
            <form method="post" action="javascript:void(0);" name="jive-comment-post-form">

                <p class="jive-error-text" id="jive-comment-error" style="display:none"></p>

                    <div class="jive-comment-post-anonymous">
                        <div>
                            <input id="comment-author" name="commentGuestName" />
                            <label for="comment-author">Name</label>
                        </div>
                        <div>
                            <input id="comment-email" name="commentGuestEmail"  />
                            <label for="comment-email">Email Address</label>
                        </div>
                        <div>
                            <input id="comment-url" name="commentGuestUrl" />
                            <label for="comment-url">Website Address</label>
                        </div>
                    </div>

                <div>
                    <textarea name="commentBody" id="wysiwygtext" rows="10" class="jive-comment-textarea"></textarea>
                </div>

                <div style="display:none;" id="jive-blog-comment-preview" class="jive-blog-comment-preview"></div>


                <div class="jive-form-buttons">
                    <input type="submit" name="post" value="Add Comment" />
                    <input type="button" name="cancel" value="Cancel" />
                </div>

            </form>
        </div>

        <div style="display:none;"  id="jive-comment-edit-block">
            <form method="post" action="javascript:void(0);" name="jive-comment-edit-form">
                <p class="jive-error-text" id="jive-comment-error" style="display:none"></p>
                <div class="jive-comment-post-anonymous">
                    <div>
                        <input name="name" value="" />
                        <label for="name">Name
                            <span>(required)</span></label>
                    </div>
                    <div>
                        <input name="email" value="" />
                        <label for="email">Email Address
                            <span>(required, will not be published)</span></label>
                    </div>
                    <div>
                        <input name="url" value=""/>
                        <label for="url">Website Address</label>
                    </div>
                </div>
                <div>
                    <textarea name="commentBody" id="wysiwygtext" rows="10" class="jive-comment-textarea"><%= commentBody %></textarea>
                </div>

                <div style="display:none;" id="jive-blog-comment-preview" class="jive-blog-comment-preview"></div>

                <div class="jive-form-buttons">
                    <input type="button" name="post" value="Save" />
                    <input type="button" name="cancel" value="Cancel" />
                </div>

            </form>
        </div>




            </div>
        </div>
        <!-- END main body column -->


        <!-- BEGIN sidebar column -->
        <div id="jive-body-sidebarcol-container">

            <div id="jive-body-sidebarcol">


<div id="jive-action-sidebar" class="jive-sidebar jive-box jive-sidebar-actions jive-box-actions">


    <div class="jive-box-header">
        <h4 id="jive-action-sidebar-tab-header_document-actions-tab">Actions</h4>
    </div>
    <div id="jive-action-sidebar-body" class="jive-sidebar-body jive-sidebar-body-actions jive-box-body">

        <div id="jive-action-sidebar-tab-_document-actions-tab"
             class="jive-action-sidebar-tab-first"
 >



            <ul id="jive-action-sidebar-tab-list_document-actions-tab" class=" jive-icon-list">
















                <li id="jive-link-thread-print" style=""
                        ><a href="DOC-10099%3Fdecorator=print.html"
rel="nofollow"
onclick=""
title="">
<span class="jive-icon-med jive-icon-print-preview"></span>
View print preview
</a></li>



            </ul>
        </div> <!-- /#jive-action-sidebar-tab-_id -->
    </div>

</div>




    <!-- BEGIN sidebar box 'More Like This' -->

    <div class="jive-box jive-sidebar">
        <div class="jive-box-header jive-sidebar-header">
            <h4>More Like This</h4>
        </div>
        <div class="jive-box-body jive-sidebar-body jive-sidebar-body-morelikethis">
            <ul class="jive-icon-list" id="jive-more-like-this-102-10099">
                <li><span>Retrieving data ...</span></li>
            </ul>
        </div>
    </div>

    <!-- END sidebar box 'More Like This' -->

    
    

        
        
        
        
        

<!-- BEGIN sidebar box 'User Content' -->
<div class="jive-box jive-sidebar">
    <div class="jive-box-header jive-sidebar-header">
        <h4>More by Zenoss API</h4>
    </div>
    <div class="jive-box-body jive-sidebar-body jive-sidebar-body-usercontent">
        <ul class="jive-icon-list">
                    <li>
                        <a href="DOC-10092.html"
                        ><span class="jive-icon-med jive-icon-document"></span>1.1 Overview</a>
                    </li>
                    <li>
                        <a href="DOC-10146.html"
                        ><span class="jive-icon-med jive-icon-document"></span>11.4 Creating a New Collector</a>
                    </li>
                    <li>
                        <a href="DOC-10123.html"
                        ><span class="jive-icon-med jive-icon-document"></span>9.2 One-to-Many (1:N) Relationships</a>
                    </li>
                    <li>
                        <a href="DOC-10088.html"
                        ><span class="jive-icon-med jive-icon-document"></span>3.3 ZenPack Structure and Contents</a>
                    </li>
                    <li>
                        <a href="DOC-10109.html"
                        ><span class="jive-icon-med jive-icon-document"></span>9.1 Add a ZenModel Relationship</a>
                    </li>
        </ul>
        <div class="jive-sidebar-viewall">
            <a href="../people/zenoss_api.html" class="font-color-meta j-link-viewall"><strong>View Zenoss API's profile</strong></a>
        </div>
    </div>
</div>
<!-- END sidebar box 'User Content' -->


            </div>

        </div>
        <!-- END sidebar column -->


    </div>



        </div>

<div class="clear"></div>
        </div>
        <!-- MAIN CONTENT END -->
     <!-- END CONTENT -->

</div>
<!-- END MIDDLE CONTENT -->

<!-- START FOOTER -->
<div id="footer">
 <table cellpadding="0" cellspacing="0" border="0">
   <tr valign="top">
      <td rowspan="2" style="padding-left:10px;padding-right:10px;">
        <ul id="socialmedia">
        <li><a href="http://feeds.feedburner.com/ZenossBlog" class="rss" target="_blank"><span>rss</span></a></li>
           <li><a href="http://twitter.com/zenoss" class="twitter" target="_blank"><span>twitter</span></a></li>
           <li><a href="http://slashdot.org/bookmark.pl" class="slashdot" target="_blank"><span>slashdot</span></a></li>
           <li><a href="http://www.reddit.com/" class="reddit" target="_blank"><span>reddit</span></a></li>
           <li><a href="http://delicious.com/save" class="del" target="_blank"><span>delicious</span></a></li>
           <li><a href="http://technorati.com/" class="tech" target="_blank"><span>technorati</span></a></li>
       </ul> 
     </td>
     <td rowspan="2" style="padding-left:10px;padding-right:10px;">
        <a href="http://twitter.com/zenoss" title="Follow us on Twitter">Follow Us On Twitter &raquo;</a>
       <ul id="twitter_update_list"> </ul>
     </td>
     <td rowspan="2" style="padding-right:10px;">
        <a href="../blogs/zenossblog.html" title="Latest from the Zenoss blog">Latest from the Zenoss Blog &raquo;</a>
       <script language="JavaScript" src="http://feed2js.org//feed2js.php?src=http%3A%2F%2Ffeeds.feedburner.com%2FZenossBlog%3Fformat%3Dxml&amp;num=3&amp;desc=85&amp;targ=y" type="text/javascript"></script>
       <noscript><a href="http://feed2js.org//feed2js.php?src=http%3A%2F%2Ffeeds.feedburner.com%2FZenossBlog%3Fformat%3Dxml&amp;num=3&amp;desc=85&amp;targ=y&amp;html=y">View RSS feed</a></noscript>
     </td>
     <td rowspan="2" valign="middle" style="padding-right:20px;">
        <img src="../themes/userbar-disabled/images/tableborder.png" alt="" />
     </td>
     <td>
        Community
       <ul class="sitemap">
        <li><a href="../index.jspa.html" title="Home">Home</a></li>
           <li><a href="community/documentation" title="Documentation">Documentation</a></li>
           <li><a href="community/developers" title="Code">Code</a></li> 
           <li><a href="community/zenpacks" title="ZenPacks">ZenPacks</a></li> 
           <li><a href="community/forums" title="Discussion">Discussion</a></li> 
           <li><a href="community/partners" title="Get Involved">Get Involved</a></li> 
           <li><a href="../people.1.html" title="Membership">Membership</a></li>
       </ul>
     </td>
     <td>
        Products
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/solution/overview" title="Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/solution/virtualization-monitoring" title="Virtualization Monitoring">Virtualization Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/cloud-monitoring" title="Cloud Monitoring">Cloud Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/cisco-ucs-management" title="Cisco UCS Management">Cisco UCS Management</a></li>
                        <li><a href="http://www.zenoss.com/solution/server-monitoring" title="Server Monitoring">Server Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/network" title="Network Monitoring">Network Monitoring</a></li>
       </ul>
     </td>
     <td>
        Services
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/support/index" title="Support Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/support/consulting" title="Consulting">Consulting</a></li>
                        <li><a href="http://www.zenoss.com/support/customer-support" title="Support">Customer Support</a></li>
                        <li><a href="http://www.zenoss.com/support/training" title="Training">Training</a></li>        
       </ul>
       Resources
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/resources/demo" title="Resources">Resource Center</a></li>
       </ul>
     </td>
     <td>
       Customers
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/customers/index" title="Customers Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/customers/case-studies/case-studies" title="Case Studies">Case Studies</a></li>
                        <li><a href="http://www.zenoss.com/customers/by-industry" title="Case Studies">Customers by Industry</a></li>
                        <li><a href="http://www.zenoss.com/customers/industries/index" title="Industries"><span>Industries</span></a></li>
       </ul>


       Partners
       <ul class="sitemap">
            <li><a href="http://www.zenoss.com/partners/open-source-network-management-solutions" title="Current Partners">Current Partners</a></li>
            <li><a href="http://www.zenoss.com/partners/contact" title="Become a Partner">Become a Partner</a></li>
       </ul>
     </td>
     <td style="padding-right:0px;">
        About Us
       <ul class="sitemap">
        <li><a href="http://www.zenoss.com/about/index" title="Overview">Overview</a></li> 
           <li><a href="http://www.zenoss.com/about/awards" title="Awards">Awards</a></li> 
           <li><a href="http://www.zenoss.com/about/team" title="Team">Team</a></li> 
           <li><a href="http://www.zenoss.com/about/news" title="News">News</a></li> 
           <li><a href="http://www.zenoss.com/about/news/events" title="Events">Events</a></li> 
           <li><a href="http://www.zenoss.com/about/jobs" title="Careers">Careers</a></li> 
           <li><a href="http://www.zenoss.com/about/contact" title="Contact">Contact</a></li>
       </ul>
     </td>
   </tr>
   <tr valign="middle">
     <td align="right">
        <a href="http://sourceforge.net/projects/zenoss" target="_blank" title="SourceForge"><img width="120" height="30" alt="Get Zenoss Core - Enterprise IT Monitoring at SourceForge.net. Fast, secure and Free Open Source software downloads" src="http://sflogo.sourceforge.net/sflogo.php?group_id=163126&amp;type=11"></a>
     </td>
     <td align="right">
        <a href="../index.html" title="Monitored by Zenoss"><img src="../themes/userbar-disabled/images/logo-monitoredby_ZEN.png" alt="Monitored By Zenoss" /></a>
     </td>
      <td colspan="3" align="right" >
        <a href="../index.html" title="Zenoss Home"><img src="../themes/userbar-disabled/images/new-logo-zenoss-footer_ZEN.gif" /></a>
       <div id="copyright" class="right">Copyright &copy; 2005-2011 Zenoss, Inc.</div>
     </td>
   </tr>
   <tr valign="top">
     <td colspan="9" align="right">&nbsp;</td>
   </tr>
 </table>
</div>
<!-- END FOOTER -->

 <!-- BEGIN SCRIPTS --> 

   <!-- END -->

    <!-- TOP NAV DROP DOWN NAVIGATION - IE6 -->
   <!-- END DROP DOWN -->       

   <!-- TWITTER SCRIPTS -->

<!-- END GOOGLE ANALYTICS CODE -->

<!-- Pardot tracking code, async version -->
<!-- END Pardot tracking code, async version -->




<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-73372470-1','auto');ga('send','pageview');</script></body>
</html>

