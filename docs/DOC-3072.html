<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>
        6.3 Monitoring Using ZenCommand - Open Source Network Monitoring and Systems Management
        
        
    </title>

    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="en-US" />
<meta name="keywords" content=""/>
<!-- 6.3 Monitoring Using ZenCommand -->
<meta property="og:image" content="servlet/JiveServlet/downloadImage/73-2574-13230/share-zenoss-logo.jpg" />

<link rel="search"
    href="../opensearch.xml"
    title="Zenoss Community"
    type="application/opensearchdescription+xml"/>


<link rel="shortcut icon" href="../themes/userbar-disabled/images/favicon.ico" />

    





    
      
      
     




    



    
    





    <link rel="stylesheet" href="../styles/jive-global.css" type="text/css" media="all" />
    <!-- <link rel="stylesheet" href="/styles/jive-icons-legacy.css" type="text/css" media="all" /> -->
    <link rel="stylesheet" href="../styles/jive-icons.css" type="text/css" media="all" />

    <link rel="stylesheet" href="../themes/userbar-disabled/styles/theme.css" type="text/css" media="all" />
    <link rel="stylesheet" href="../themes/userbar-disabled/styles/community.css" type="text/css" media="all" />
    <link rel="stylesheet" href="../themes/userbar-disabled/styles/sifr.css" type="text/css" media="all" />


    <!--[if IE 6]>
    <style type="text/css">
    /* hack for IE6's lack of alpha PNG support */
    * html #jive-wrapper .ie6png,
    * html #jive-wrapper #jive-global-header *.ie6png,
    * html #jive-wrapper #user-bar-wrapper *.ie6png,
    * html #jive-wrapper #jive-body *.ie6png,
    * html #jive-wrapper #jive-footer *.ie6png {
        background-image: expression(
        this.runtimeStyle.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src=" +
        (this.tagName=='IMG' ? this.src : this.currentStyle.backgroundImage.split('\"')[1]) + ")",
        this.runtimeStyle.backgroundImage = "none",
        this.src = "/images/transparent.png"
        );
        }
    </style>

    <link rel="stylesheet" href="/styles/jive-icons-ie.css" type="text/css" media="all" />
    <![endif]-->





    
    

	<link rel="stylesheet" href="../4.5.6/styles/jive-content.css" type="text/css" media="all" />

        <link rel="alternate" type="application/rss+xml"
            title="6.3 Monitoring Using ZenCommand Version History Feed"
            href="../community/feeds/document-history/DOC-3072" />

        <link rel="alternate" type="application/rss+xml"
            title="6.3 Monitoring Using ZenCommand Comments Feed"
            href="../community/feeds/document-comments/DOC-3072" />

    
        




    <!-- BEGIN action bar, only for non-binary documents -->

    

    <!-- END action bar -->




    <style type="text/css">/* Rating bar on documents */
.jive-content .jive-content-header .jive-content-rating {margin-bottom: 3px;}
.j-rating { padding: 0 10px; }
.jive-content-avgrating {height: 53px;}
/* END Rating bar on documents */

/* Userbar */
#jive-userbar-right {right: 50px;}
/* END Userbar */

/* Download links page */
table.download-links-table {background-color: #ffffff; width: 100%;}
table.download-links-table tbody td { text-align: center; vertical-align: middle;}
table.download-links-table thead th {text-align: center;}
table.download-links-table td, table.download-links-table th {border: 1px solid #EEEEEE !important;}

/* Provides indentation for official doc ToC items */
div.toc dl dt {margin-left: 20px;}
div.toc dl dd dl dt {margin-left: 40px;}
div.toc dl dd dl dd dl dt {margin-left: 60px;}
div.toc dl dd dl dd dl dd dl dt {margin-left: 80px;}
div.toc dl dd dl dd dl dd dl dd dl dt {margin-left: 100px;}
/* END docs items */


/* Blog posts */
div.social-button-spacer {height: 10px;}

div#social-button-cont {
margin-right:10px; 
padding:5px; 
text-align: center; 
float: right;
}

div#comment-indicator {
    float: left;
    left: 12px;
    right: inherit;
    top: 55px;
}

div#comment-indicator div.jive-reply {margin-left: 0px;}

.jive-blog-post-subject {padding-bottom: 0px;}
/* END Blog posts */


/* Community download survey */
form#core-usage-survey label.aligned {float: left; width: 120px;}
form#core-usage-survey span.required_field {color: red;}
form#core-usage-survey label.survey-small-label {display:inline;}
form#core-usage-survey div.survey-checkbox-set {width:82%;}
form#core-usage-survey div.border {border:1px solid #ACACAC; padding:5px;}

form#core-usage-survey label.survey-resource_type {font-style:italic;}
form#core-usage-survey label {
color:#333333;
display:block;
font-size:12px;
font-weight:bold;
}
/* END Community download survey */

</style>
    <style type="text/css">/* custom-css-container */</style>


</head>
<body class="jive-body-home" ><div style="width:100%;background-color:white;float:left;position:fixed;z-index:3000;top:0;right:0;border-bottom:2px solid gray;"><div style="width:1006px;font-weight:bold;margin:12px auto 12px auto;font-size:18px;"><div style="float: left; margin: 0;">Archived community.zenoss.org | full text search <form style="display: inline;" target="_blank" action="https://github.com/monitoringartist/community.zenoss.org/search" method="get"><input type="text" name="q"><input type="submit" value="Search"></form> </div><div style="float: right;"><a href="https://www.monitoringartist.com" title="Maintained by Monitoring Artist - DevOps / Docker / Kubernetes / Zabbix / Zenoss / Monitoring"><img src="assests-monitoringartist/Monitoring-Artist-logo.png" /></a></div></div></div>


<a href="DOC-3072.html#jive-body" class="jive-skip-nav">Skip navigation</a>

    <div id="jive-compliance" class=""style="display:none">
        <span class="jive-icon-med "></span>
        
    </div>

    <div id="jive-wrapper" class="clearfix">

    <!-- Load search for guests -->

    <div id="jive-userbar-search">
    <form action="search.jspa" method="get" id="jive-userbar-search-form">
        <input type="hidden" name="peopleEnabled" value="true"/>

        <input type="hidden" name="userID"/>
        <input type="hidden" name="containerType"/>
        <input type="hidden" name="container"/>
        <input type="hidden" name="spotlight" value="false"/>
        <label for="jive-query"
               class="j-508-label">Search for:</label>
        <input type="text" id="jive-query" name="q" value="" accesskey="4" class="searchbar jive-userbar-search-field"
               autocomplete="off"/>
    </form>

    <div id="jive-spotlight-search-container"></div>
</div>

    <!-- END anon search -->

<!-- SKIP NAV FOR ACCESSIBILITY -->
<a href="DOC-3072.html#skipnav"></a>
<!-- END -->

<div id="header">

    <!-- START TOP NAVIGATION -->
    <div id="navcontainer">
        <table cellpadding="0" cellspacing="0" width="100%" border="0">
          <tr valign="bottom">
            <td rowspan="2">
                <a href="../index.html" title="Zenoss Open Source IT Management"><img src="../themes/userbar-disabled/images/zenoss-logo-reversed-web.png" style="width:254px; margin: 0 0px 25px;" alt="Zenoss Open Enterprise Management" /></a>
            </td>
            <td height="45" colspan="2">
                <div id="zenoss-panel">
                    <div style="width: 200px;" id="cpanel-lt"></div>
                    <ul id="subnav-rt" class="png_fix">
                        <li><a href="http://www.zenoss.com/" title="Zenoss.Inc Home" class="none">Zenoss, Inc.</a></li>
                        <!--<li><a href="/community/feedback" title="Feedback" class="none">Feedback</a></li>-->
                        <!--<li><a href="http://www.zenoss.com/support" title="Support" class="none">Support</a></li>-->
                    </ul>
                </div>
            </td>
          </tr>
          <tr valign="middle">
            <td colspan="2" height="80">
                <ul id="navlist">
                    <li><a href="community/documentation" title="DOCS" class="nav1"><span>DOCS</span></a></li>
                    <li><a href="community/forums" title="FORUMS" class="nav2"><span>FORUMS</span></a></li>        
                    <!--<li><a href="/community/zenpacks" title="ZENPACKS" class="nav3"><span>ZENPACKS</span></a></li>-->
                    <li><a href="http://wiki.zenoss.org/Category:ZenPacks" title="ZENPACKS" class="nav3"><span>ZENPACKS</span></a></li>        
                    <li><a href="community/partners" title="PARTNERS" class="nav4"><span>PARTNERS</span></a></li>      
                    <li><a href="community/about" title="ABOUT" class="nav4"><span>ABOUT</span></a></li>   
                    <li><a href="../blogs/zenossblog.html" title="BLOG" class="nav5"><span>BLOG</span></a></li>
                    <li><a href="community/testing" title="TESTING" class="nav5"><span>TESTING</span></a></li> 
                    <li><a href="community/developers" title="DEVELOPERS" class="nav6"><span>DEVELOPMENT</span></a></li>
                    <li><a href="../community/download.html" title="DOWNLOADS" class="nav7 png_fix"><span>DOWNLOAD</span></a></li>
                </ul>
            </td>
          </tr>
        </table>
    </div>
    <!-- END TOP NAV -->

</div>

<!-- START MID COL -->
<div id="middle">

    <!-- SKIPNAV ADDED FOR ACCESSIBILITY -->
    <a name="skipnav"></a>
    <!-- SKIPNAV END -->
        
      <!-- START CONTENT -->
      
        <!-- MAIN CONTENT START -->
        <!-- CHANGE CLASS ACCORDING TO SUB SECTION FOR PROPER TOP BANNER -->


        <div id="subcontent">




<!-- BEGIN user bar -->
<div id="user-bar-wrapper">
    <div id="jive-userbar">
<div id="jive-userbar-login">
    <form action="https://community.zenoss.org/cs_login"
          method="post" name="loginform" autocomplete="off">
        
        

        <span class="jive-userbar-login-welcome" id="jiveLoginWelcome">
            <span class="jive-userbar-login-guest">
            Welcome, Guest
            </span>

            <span class="jive-userbar-login-loginlink">
                <a href="DOC-3072.html#" onClick="jivetoggleLogin(); return false;">Login</a>
            </span>

            <span class="jive-userbar-login-new">
                <a href="../login!input.jspa%3FregisterOnly=true.html">Register</a>
            </span>
        </span>

        <span class="jive-userbar-login-form" id="jiveLoginForm" style="display: none;">

            <span class="jive-userbar-login-username">
                <label for="login-username">
Username:                </label>
                <a href="docs/forgot-username!input.jspa" title="I forgot my username ">(?)</a>
                <input type="text" name="username" size="20" maxlength="150" value="" tabindex="1"
                               id="login-username" />
            </span>

            <span class="jive-userbar-login-password">
                <label for="login-password">
Password:                </label>
                <a href="docs/emailPasswordToken!input.jspa" title="I forgot my password ">(?)</a>
                <input type="password" name="password" size="20" maxlength="150" value="" tabindex="2"
                               id="login-password" />
            </span>

            <span class="jive-userbar-login-auto">
                <input type="checkbox" name="autoLogin" id="login-auto" value="true" tabindex="3" />
                <label for="login-auto">Remember Me</label>
            </span>

            <span class="jive-userbar-login-submit">
                <input type="submit" name="login" value="Login" tabindex="4"
                       class="jive-login-button" />
                <input type="reset" name="doCancel" value="Cancel" tabindex="5"
                               class="jive-cancel-button" onclick="jivetoggleLogin();" />
            </span>
        </span>

    </form>
</div>        <div id="jive-userbar-right">

    <div id="jive-userbar-search">
    <form action="search.jspa" method="get" id="jive-userbar-search-form">
        <input type="hidden" name="peopleEnabled" value="true"/>

        <input type="hidden" name="userID"/>
        <input type="hidden" name="containerType"/>
        <input type="hidden" name="container"/>
        <input type="hidden" name="spotlight" value="false"/>
        <label for="jive-query"
               class="j-508-label">Search for:</label>
        <input type="text" id="jive-query" name="q" value="" accesskey="4" class="searchbar jive-userbar-search-field"
               autocomplete="off"/>
    </form>

    <div id="jive-spotlight-search-container"></div>
</div>

        </div>
    </div>

</div>
<!-- END user bar -->

            <div id="jive-body">

<!-- BEGIN breadcrumb -->
<div id="jive-breadcrumb">

    <span>
                <a href="../index.jspa.html">
            Zenoss Community</a> &gt; 
                <a href="community/documentation">
            Documentation</a> &gt; 
                <a href="community/documentation/official_documentation">
            Zenoss Core Product Documentation</a> &gt; 
                <a href="community/documentation/official_documentation/zenoss-guide">
            Zenoss Administration</a> &gt; 
                <a href="../community/documentation/official_documentation/zenoss-guide/2.4.3">
            2.4.3</a> &gt; 

        <a class='jive-breadcrumb-last' href="../community/documentation/official_documentation/zenoss-guide/2.4.3%3Fview=documents">Documents</a></span>
</div>
<!-- END breadcrumb -->

            

    <form id="documentRestoreForm" method="post" action='docs/DOC-3072/restore'>
        <input type="hidden" name="version" value="2" />
        <input type="hidden" name="jive.token.name" value="document.restore.DOC-3072"/>
        <input type="hidden" name="document.restore.DOC-3072" value="1394830639007-OXWZ0YO51CKBJNCY3799MGXIFIFLVXDF"/>
    </form>

    <form id="documentDeleteForm" method="post" action='docs/DOC-3072/delete'>
        <input type="hidden" name="jive.token.name" value="document.delete.DOC-3072"/>
        <input type="hidden" name="document.delete.DOC-3072" value="1394830639013-67ONBSX5386OC3KHITSBULVQ6MKFHVIV"/>
    </form>

    <form id="documentPublishForm" method="post" action='doc-publish.jspa'>
        <input type="hidden" name="jive.token.name" value="document.publish.DOC-3072"/>
        <input type="hidden" name="document.publish.DOC-3072" value="1394830639018-ID3MFT0I9SW6NT6Z8N0LPQBQ7D62CIKE"/>
        <input type="hidden" name="document" value="DOC-3072" />
    </form>


    <!-- BEGIN header & intro  -->
    <div id="jive-body-intro">
        <div id="jive-body-intro-content">
            
            <a href="../community/documentation/official_documentation/zenoss-guide/2.4.3%3Fview=documents"><span class="jive-icon-sml jive-icon-arrow-generic-up"></span>
                    Up to Documents in 2.4.3
            </a>

        </div>
    </div>
    <!-- END header & intro -->

    <!-- BEGIN main body -->
    <div id="jive-body-main">

        <!-- BEGIN main body column -->
        <div id="jive-body-maincol-container">

            <div id="jive-body-maincol">


                <div id="thread.watch.notify" class="jive-info-box" style="display:none"></div>

                <div id="content-featured-notify" class="jive-info-box" style="display:none"></div>








<!-- BEGIN document -->
<div class="jive-content clearfix">
    <div class="jive-content-header clearfix">
        <div class="jive-wiki-post-moderating jive-content-header-moderating">
            <span class="jive-icon-med jive-icon-moderation"></span>Currently Being Moderated
        </div>
        <div class="jive-content-title">
            <h2><span class="jive-icon-big jive-icon-document"></span>6.3 Monitoring Using ZenCommand</h2>
        </div>
        <div class="jive-content-header-version">
            VERSION 2&nbsp;
                <a href="docs/DOC-3072/diff?secondVersionNumber=2" title="Click to view document history"><img class="jive-icon-sml jive-icon-search" src="../4.5.6/images/transparent.png" alt="Click to view document history" /></a>


        </div>
        <div class="jive-content-header-details">

Created on: Sep 14, 2009 11:39 AM by
<a href="../people/zenoss_api.html"
data-externalId=""
data-username="zenoss_api"
data-avatarId="-1"
id="jive-692632882042097078208"
onmouseover="var presence = null; quickuserprofile.getUserProfileTooltip( 6926, presence );"
onmouseout="quickuserprofile.cancelTooltip();"
class="jiveTT-hover-user jive-username-link"
>Zenoss API</a>            <span>-</span>
Last Modified:&nbsp;
Sep 14, 2009 5:45 PM
by <a href="../people/jhamilton.html"
data-externalId=""
data-username="jhamilton"
data-avatarId="1024"
id="jive-541932882042097677986"
onmouseover="var presence = null; quickuserprofile.getUserProfileTooltip( 5419, presence );"
onmouseout="quickuserprofile.cancelTooltip();"
class="jiveTT-hover-user jive-username-link"
>John Hamilton</a>        </div>

        <div class="jive-content-rating clearfix" data-guid="F77H85R1MUKIDD52HPPWQEEK8J6KMAG1">

<script type='text/javascript'>
    $j(document).ready(function() {

        var i18n = {
            avgUserRatingTitlei18n : "Average User Rating",
            avgUserRatingLabeli18n : "Average User Rating",
            rateRatingLabel : "rating",
            myRatingLabel : "My Rating:",
            rateRatingsLabel : "ratings",
            ratingSavingText : "Saving...",
            rateSavedText : "Saved.",
            rateRatingSaved : "Rating Saved!",
            writeAReview : "Write a review",
            commentOnRating : "Comment on your rating",
            formSubmitPleaseWait:'Please Wait ...'
        };

        new jive.Rate(14, 2158, 102, 3072, 'doc', i18n, true, 'F77H85R1MUKIDD52HPPWQEEK8J6KMAG1');
    });

</script>

        </div>
    </div>

    <div class="jive-content-body">


<!-- [DocumentBodyStart:2f26e542-a026-4f25-8fa4-363fb4f83f26] --><div class="jive-rendered-content"><div class="navheader"><table summary="Navigation header" width="100%"><tbody><tr><th align="center" colspan="3" style=";">3. Monitoring Using ZenCommand</th></tr><tr><td align="left" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-guide/2.4.3/ch06s02.html">Prev</a> </td><th align="center" style=";" width="60%">Chapter 6. Core Monitoring</th><td align="right" style=";" width="20%"> <a class="jive-link-external-small" href="zenoss-guide/2.4.3/ch06s04.html">Next</a></td></tr></tbody></table><hr/></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a class="jive-link-anchor-small" name="d4e3044">#</a>3. Monitoring Using ZenCommand</h2></div></div></div><p>Read the following sections for more information about monitoring using ZenCommand.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="d4e3047">#</a>3.1. About ZenCommands</h3></div></div></div><p>Zenoss has the ability to run Nagios&#174; and Cactii plug-ins though the ZenCommand process. ZenCommand can run plugins locally and remotely by using a native SSH transport. When run, Zenoss tracks the return code of each plug-in and then creates events with plug-in output. Additionally, Zenoss can track performance information from a plug-in.</p><div class="figure"><a class="jive-link-anchor-small" name="d4e3050">#</a><p class="title"><strong>Figure 6.21. Running ZenCommands</strong></p><div class="figure-contents"><div class="mediaobject"><span style="border-collapse: collapse;"><a href="../servlet/JiveServlet/showImage/102-3072-2-1345/runningzencommand.png"><img alt="runningzencommand.png" class="jive-image" height="246" src="../servlet/JiveServlet/downloadImage/102-3072-2-1345/450-246/runningzencommand.png" width="450"/></a></span></div></div></div><br class="figure-break"/></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="d4e3055">#</a>3.2. Example: Writing a ZenCommand (check_http example)</h3></div></div></div><p>You can use a ZenCommand plugin (check_http) to check for specific content of a Web page. (This implicitly checks for server/page 200 status as well.)</p><p>The following example procedure shows how to set up a ZenCommand plugin to check specific content. The steps show how to test the plugin, and then integrate it with Zenoss.</p><div class="orderedlist"><ol type="1"><li><p>As the zenoss user, test the plugin from the command line. Enter the following command to test the product directory:</p><pre class="programlisting">$ZENHOME/libexec/check_http -H www.zenoss.com</pre><p>If the check_http command is correct, the output will look similar to the following.</p><pre class="programlisting">HTTP OK HTTP/1.0 200 OK - 0.723 second response time |time=0.722758s;;;0.000000 size=7932B;;;0</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The <code class="filename">check_http -h</code> command displays all plugin options.</p></div></li><li><p>Add the device you want to check (one running a "www" Web site) to the Zenoss system, setting the discovery protocol to "none."</p></li><li><p>Navigate to the device in Zenoss, and then select More &gt; Templates from the page menu.</p></li><li><p>Click <span class="bold"><strong>Create Local Copy</strong></span>.</p><p>The default device template is overridden with the device template specific to this device.</p></li><li><p>In the template, remove the sysUpTime data source. (In this example, SNMP is not used for the device.)</p></li><li><p>Add a new description to the template.</p></li><li><p>Add a new data source called rootWebCheck.</p></li><li><p>In the rootWebCheck data source, set the following variables:</p><div class="itemizedlist"><ul type="disc"><li><p>Source Type = COMMAND</p></li><li><p>Component = rootWebCheck</p></li><li><p>Cycle Time = 30</p></li></ul></div></li><li><p>Debug your ZenCommand by running zencommand in the foreground with debugging on:</p><pre class="programlisting">zencommand run -d <span class="emphasis"><em>www.website.com</em></span> -v10</pre><p>Where <span class="emphasis"><em>www.website.com</em></span> is the site you want to monitor.</p><p>The command template field is a TALES expression. You can make substitutions in the command that will make it generic for any device added to this class.</p></li><li><p>Set the <code class="filename">-H</code> flag to the IP of the device against which this command will be run, as follows:</p><pre class="programlisting">check_http -H ${here/manageIp}</pre></li><li><p>Add a check looking for content on the page. The <code class="filename">-r</code> flag will run a regular expression against the Web page to check for text.</p><pre class="programlisting">check_http -H ${here/manageIp}-r <span class="emphasis"><em>textstring1</em></span></pre><p>Where <span class="emphasis"><em>textsrting1</em></span> is text you know is on the resulting Web page.</p></li><li><p>For this example, the command should be generic. Make a custom field for the regex that can be changed per device. Set the default to &ldquo;.*&#8221;, which will match everything. Go to /Devices/Custom Schema and add a new field:</p><div class="itemizedlist"><ul type="disc"><li><p>Label = Web Match Regex</p></li><li><p>Name = cWebMatchRegex</p></li><li><p>Type = string</p></li><li><p>Default = .*</p></li><li><p>Visible = True</p></li></ul></div></li><li><p>Return to the template and change the command to be.</p><pre class="programlisting">check_http -H ${here/manageIp}-r ${here/cWebMatchRegex}</pre></li><li><p>Add the regex value into cWebMatchRegex (used in the example above).</p></li><li><p>Test the ZenCommand from the command line.</p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="d4e3129">#</a>3.3. Example: Collect Data from A ZenCommand</h3></div></div></div><p>To collect and display data from the ZenCommand check_http example, you can log the data to see something like response time in a graphical format.</p><div class="orderedlist"><ol type="1"><li><p>Navigate to /Web/Device template.</p></li><li><p>Go to the data source created in the check_http example.</p></li><li><p>In the Data Points table, add a data point named "time." (No modifications are needed to the data point.)</p></li><li><p>Test the command again. You should see a log message that starts with:</p><pre class="programlisting">DEBUG:zen.zencommand:storing responseTime = 1.0</pre></li><li><p>Make a graph to display the data. In the device template, create a graph called &ldquo;Web Response Time."</p></li><li><p>For this graph, set the following values:</p><div class="itemizedlist"><ul type="disc"><li><p>Data Sources = rootWebCheck_responseTime</p></li><li><p>Units = Seconds</p></li><li><p>Min Y = 0</p></li></ul></div></li><li><p>View the Perf tab for the device www.website.com (the Web site you were using to check) to see the graph. Graph data will not appear until collection is run several times. Restart zencommand so that the new configuration takes effect immediately.</p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="d4e3155">#</a>3.4. Plugin Format for ZenCommands</h3></div></div></div><p>Nagios&#174; plugins are configured by using a command template that is much like the RRDTemplates used for performance monitoring.</p><p>A template named &ldquo;Device&#8221; will bind to all devices below the template definition. Within each template is a list of commands that will run. The commands can be any program that follows the Nagios&#174; plug-in standard. Inputs are command line arguments; output is the first line of stdout, plus a return code.</p><p>For complete information about Nagios plugin guidelines, browse to this location:</p><p><a class="jive-link-external-small" href="http://nagiosplug.sourceforge.net/developer-guidelines.html">http://nagiosplug.sourceforge.net/developer-guidelines.html</a></p><p>A Nagios&#174; command has several fields:</p><div class="itemizedlist"><ul type="disc"><li><p>name &ndash; Specifies the name of the command object.</p></li><li><p>enabled &ndash; Indicates whether this command should be used on a given device.</p></li><li><p>component &ndash; Specifies the component name to use when zencommand sends events to Zenoss.</p></li><li><p>event class &ndash; Specifies the event class to use when sending events to Zenoss.</p></li><li><p>severity &ndash; Sets the default severity to use when sending events to Zenoss.</p></li><li><p>cycle time &ndash; Sets the frequency a command should be run (in seconds).</p></li><li><p>command template &ndash; Specifies the command to run.</p><p>The command template string is built by using Zope TALES expressions. Several variables are passed when evaluating the template. They are:</p></li><li><p>zCommandPath &ndash; Path to the zencommand plug-ins on a given box it comes from the zProperty zCommandPath. zCommandPath is automatically added to a command if a path is absent from the beginning of the command.</p></li><li><p>devname &ndash; Device name of the device against which the command is being evaluated.</p></li><li><p>dev &ndash; Device object against which the command is being evaluated.</p></li><li><p>here &ndash; Context of evaluation. For a device, this is equivalent to dev for a component (such as a filesystem or interface). This is the component object.</p></li><li><p>compname &ndash; If this command evaluates against a component, specifies its name as a string.</p></li><li><p>now &ndash; Current time.</p><p>Template values are accessed like shell variables. They are the same as the expression syntax used in the appendix titled TALES Expressions (in this guide).</p><h4><a class="jive-link-anchor-small" name="d4e3192">#</a>Examples</h4><p>Run an http check against all devices by using the URL /zport/dmd:</p><pre class="programlisting">check_http &ndash;H ${devname}-u /zport/dmd</pre><p>In a template named FileSystem, the following command will run against all file systems on a device:</p><pre class="programlisting">check_disk &ndash;w 10% -c 5% -p ${compname}</pre></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a class="jive-link-anchor-small" name="d4e3197">#</a>3.5. Testing ZenCommands</h3></div></div></div><p>You can test ZenCommand data sources by using the zentestcommand shell script.</p><p>From the command line, run:</p><pre class="programlisting">zentestcommand &ndash;d <span class="emphasis"><em>DeviceName</em></span> --datasource=<span class="emphasis"><em>DataSourceName</em></span></pre><p>where <span class="emphasis"><em>DeviceName</em></span> is the device on which you want to run the command, and <span class="emphasis"><em>DataSourceName</em></span> is the name of a data source on a template associated with the device.</p><p>The zentestcommand script prints the results of the command to standard output.</p></div></div><div class="navfooter"><hr/><table summary="Navigation footer" width="100%"><tbody><tr><td align="left" style=";" width="40%"><a class="jive-link-external-small" href="zenoss-guide/2.4.3/ch06s02.html">Prev</a> </td><td align="center" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-guide/2.4.3/ch06.html">Up</a></td><td align="right" style=";" width="40%"> <a class="jive-link-external-small" href="zenoss-guide/2.4.3/ch06s04.html">Next</a></td></tr><tr><td align="left" style=";" valign="top" width="40%">2. Performance Monitoring </td><td align="center" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-guide/2.4.3/index.html">Home</a></td><td align="right" style=";" valign="top" width="40%"> 4. SNMP Monitoring</td></tr></tbody></table></div></div><!-- [DocumentBodyEnd:2f26e542-a026-4f25-8fa4-363fb4f83f26] -->

<!-- BEGIN attachments -->
<!-- END attachments -->
    </div>
    <div class="jive-content-footer clearfix">


    <!-- BEGIN content details -->
        <span class="jive-content-footer-item jive-content-footer-acclaim">

<div id="acclaim-container-102-3072-" class="acclaim-container">
    <div id="jive-acclaim-like-container-102-3072-" data-uniqueKey="102-3072-" data-ratingType="like" data-hasVoted="false" data-likes="0" class="acclaim-like-container">
         <span class="jive-icon-sml jive-icon-like"></span>Like
         (<a href="DOC-3072.html#" id="jive-acclaim-likedlink-102-3072-"  class=" jive-acclaim-likedlink">0</a>)
    </div>
</div>        </span>

     
        <span class="jive-content-footer-item">
            30451&nbsp;Views
        </span>

        



    <!-- BEGIN view/add/edit tags -->
    <span class="jive-content-footer-item jive-content-footer-tags">
    </span>
    <!-- END view/add/edit tags -->
<!-- END content -->

    </div>
</div>
<!-- END document -->





    
    <script>
    </script>






    <link rel="stylesheet" type="text/css" href="../4.5.6/styles/tiny_mce3/plugins/inlinepopups/skins/clearlooks2/window.css" />




    




        <a name="comments"></a>

        <!-- BEGIN tabs -->
        <div class="jive-body-tabbar">

                <span id="jive-comments-tab" class="jive-body-tab jive-body-tabcurrent">
                    <strong class="font-color-normal">
                        Comments (<span id="jive-comments-count">0</span>)
                    </strong>
                </span>

        </div>
        <!-- END tabs -->

            <div class="jive-box clearfix" id="jive-comments" ></div>

        <div style="display:none;" id="jive-comment-post-block">
            <form method="post" action="javascript:void(0);" name="jive-comment-post-form">

                <p class="jive-error-text" id="jive-comment-error" style="display:none"></p>

                    <div class="jive-comment-post-anonymous">
                        <div>
                            <input id="comment-author" name="commentGuestName" />
                            <label for="comment-author">Name</label>
                        </div>
                        <div>
                            <input id="comment-email" name="commentGuestEmail"  />
                            <label for="comment-email">Email Address</label>
                        </div>
                        <div>
                            <input id="comment-url" name="commentGuestUrl" />
                            <label for="comment-url">Website Address</label>
                        </div>
                    </div>

                <div>
                    <textarea name="commentBody" id="wysiwygtext" rows="10" class="jive-comment-textarea"></textarea>
                </div>

                <div style="display:none;" id="jive-blog-comment-preview" class="jive-blog-comment-preview"></div>


                <div class="jive-form-buttons">
                    <input type="submit" name="post" value="Add Comment" />
                    <input type="button" name="cancel" value="Cancel" />
                </div>

            </form>
        </div>

        <div style="display:none;"  id="jive-comment-edit-block">
            <form method="post" action="javascript:void(0);" name="jive-comment-edit-form">
                <p class="jive-error-text" id="jive-comment-error" style="display:none"></p>
                <div class="jive-comment-post-anonymous">
                    <div>
                        <input name="name" value="" />
                        <label for="name">Name
                            <span>(required)</span></label>
                    </div>
                    <div>
                        <input name="email" value="" />
                        <label for="email">Email Address
                            <span>(required, will not be published)</span></label>
                    </div>
                    <div>
                        <input name="url" value=""/>
                        <label for="url">Website Address</label>
                    </div>
                </div>
                <div>
                    <textarea name="commentBody" id="wysiwygtext" rows="10" class="jive-comment-textarea"><%= commentBody %></textarea>
                </div>

                <div style="display:none;" id="jive-blog-comment-preview" class="jive-blog-comment-preview"></div>

                <div class="jive-form-buttons">
                    <input type="button" name="post" value="Save" />
                    <input type="button" name="cancel" value="Cancel" />
                </div>

            </form>
        </div>




            </div>
        </div>
        <!-- END main body column -->


        <!-- BEGIN sidebar column -->
        <div id="jive-body-sidebarcol-container">

            <div id="jive-body-sidebarcol">


<div id="jive-action-sidebar" class="jive-sidebar jive-box jive-sidebar-actions jive-box-actions">


    <div class="jive-box-header">
        <h4 id="jive-action-sidebar-tab-header_document-actions-tab">Actions</h4>
    </div>
    <div id="jive-action-sidebar-body" class="jive-sidebar-body jive-sidebar-body-actions jive-box-body">

        <div id="jive-action-sidebar-tab-_document-actions-tab"
             class="jive-action-sidebar-tab-first"
 >



            <ul id="jive-action-sidebar-tab-list_document-actions-tab" class=" jive-icon-list">
















                <li id="jive-link-thread-print" style=""
                        ><a href="DOC-3072%3Fdecorator=print.html"
rel="nofollow"
onclick=""
title="">
<span class="jive-icon-med jive-icon-print-preview"></span>
View print preview
</a></li>



            </ul>
        </div> <!-- /#jive-action-sidebar-tab-_id -->
    </div>

</div>




    <!-- BEGIN sidebar box 'More Like This' -->

    <div class="jive-box jive-sidebar">
        <div class="jive-box-header jive-sidebar-header">
            <h4>More Like This</h4>
        </div>
        <div class="jive-box-body jive-sidebar-body jive-sidebar-body-morelikethis">
            <ul class="jive-icon-list" id="jive-more-like-this-102-3072">
                <li><span>Retrieving data ...</span></li>
            </ul>
        </div>
    </div>

    <!-- END sidebar box 'More Like This' -->

    
    

<!-- BEGIN sidebar box 'Incoming Links' -->
<div class="jive-box jive-sidebar">
    <div class="jive-box-header jive-sidebar-header">
        <h4>Incoming Links</h4>
    </div>
    <div class="jive-box-body jive-sidebar-body jive-sidebar-body-incominglinks">
        <ul class="jive-icon-list">
                        <li>
                            <a href="../message/40837.html#40837">
                            <span class="jive-icon-med jive-icon-discussion-question"></span>
                                Re: Custom script output parsing?
                            </a>
                        </li>
        </ul>
    </div>
</div>
<!-- END sidebar box 'Incoming Links' -->


        
        
        
        
        

<!-- BEGIN sidebar box 'User Content' -->
<div class="jive-box jive-sidebar">
    <div class="jive-box-header jive-sidebar-header">
        <h4>More by Zenoss API</h4>
    </div>
    <div class="jive-box-body jive-sidebar-body jive-sidebar-body-usercontent">
        <ul class="jive-icon-list">
                    <li>
                        <a href="DOC-3106.html"
                        ><span class="jive-icon-med jive-icon-document"></span>5.1 zProperties</a>
                    </li>
                    <li>
                        <a href="DOC-3038.html"
                        ><span class="jive-icon-med jive-icon-document"></span>12.7 MultiGraph Reports</a>
                    </li>
                    <li>
                        <a href="DOC-3061.html"
                        ><span class="jive-icon-med jive-icon-document"></span>1.1 Zenoss High-Level View</a>
                    </li>
                    <li>
                        <a href="DOC-3093.html"
                        ><span class="jive-icon-med jive-icon-document"></span>4.2 Managing Devices and Device Attributes</a>
                    </li>
                    <li>
                        <a href="DOC-3083.html"
                        ><span class="jive-icon-med jive-icon-document"></span>Zenoss Administration</a>
                    </li>
        </ul>
        <div class="jive-sidebar-viewall">
            <a href="../people/zenoss_api.html" class="font-color-meta j-link-viewall"><strong>View Zenoss API's profile</strong></a>
        </div>
    </div>
</div>
<!-- END sidebar box 'User Content' -->


            </div>

        </div>
        <!-- END sidebar column -->


    </div>



        </div>

<div class="clear"></div>
        </div>
        <!-- MAIN CONTENT END -->
     <!-- END CONTENT -->

</div>
<!-- END MIDDLE CONTENT -->

<!-- START FOOTER -->
<div id="footer">
 <table cellpadding="0" cellspacing="0" border="0">
   <tr valign="top">
      <td rowspan="2" style="padding-left:10px;padding-right:10px;">
        <ul id="socialmedia">
        <li><a href="http://feeds.feedburner.com/ZenossBlog" class="rss" target="_blank"><span>rss</span></a></li>
           <li><a href="http://twitter.com/zenoss" class="twitter" target="_blank"><span>twitter</span></a></li>
           <li><a href="http://slashdot.org/bookmark.pl" class="slashdot" target="_blank"><span>slashdot</span></a></li>
           <li><a href="http://www.reddit.com/" class="reddit" target="_blank"><span>reddit</span></a></li>
           <li><a href="http://delicious.com/save" class="del" target="_blank"><span>delicious</span></a></li>
           <li><a href="http://technorati.com/" class="tech" target="_blank"><span>technorati</span></a></li>
       </ul> 
     </td>
     <td rowspan="2" style="padding-left:10px;padding-right:10px;">
        <a href="http://twitter.com/zenoss" title="Follow us on Twitter">Follow Us On Twitter &raquo;</a>
       <ul id="twitter_update_list"> </ul>
     </td>
     <td rowspan="2" style="padding-right:10px;">
        <a href="../blogs/zenossblog.html" title="Latest from the Zenoss blog">Latest from the Zenoss Blog &raquo;</a>
       <script language="JavaScript" src="http://feed2js.org//feed2js.php?src=http%3A%2F%2Ffeeds.feedburner.com%2FZenossBlog%3Fformat%3Dxml&amp;num=3&amp;desc=85&amp;targ=y" type="text/javascript"></script>
       <noscript><a href="http://feed2js.org//feed2js.php?src=http%3A%2F%2Ffeeds.feedburner.com%2FZenossBlog%3Fformat%3Dxml&amp;num=3&amp;desc=85&amp;targ=y&amp;html=y">View RSS feed</a></noscript>
     </td>
     <td rowspan="2" valign="middle" style="padding-right:20px;">
        <img src="../themes/userbar-disabled/images/tableborder.png" alt="" />
     </td>
     <td>
        Community
       <ul class="sitemap">
        <li><a href="../index.jspa.html" title="Home">Home</a></li>
           <li><a href="community/documentation" title="Documentation">Documentation</a></li>
           <li><a href="community/developers" title="Code">Code</a></li> 
           <li><a href="community/zenpacks" title="ZenPacks">ZenPacks</a></li> 
           <li><a href="community/forums" title="Discussion">Discussion</a></li> 
           <li><a href="community/partners" title="Get Involved">Get Involved</a></li> 
           <li><a href="../people.1.html" title="Membership">Membership</a></li>
       </ul>
     </td>
     <td>
        Products
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/solution/overview" title="Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/solution/virtualization-monitoring" title="Virtualization Monitoring">Virtualization Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/cloud-monitoring" title="Cloud Monitoring">Cloud Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/cisco-ucs-management" title="Cisco UCS Management">Cisco UCS Management</a></li>
                        <li><a href="http://www.zenoss.com/solution/server-monitoring" title="Server Monitoring">Server Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/network" title="Network Monitoring">Network Monitoring</a></li>
       </ul>
     </td>
     <td>
        Services
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/support/index" title="Support Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/support/consulting" title="Consulting">Consulting</a></li>
                        <li><a href="http://www.zenoss.com/support/customer-support" title="Support">Customer Support</a></li>
                        <li><a href="http://www.zenoss.com/support/training" title="Training">Training</a></li>        
       </ul>
       Resources
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/resources/demo" title="Resources">Resource Center</a></li>
       </ul>
     </td>
     <td>
       Customers
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/customers/index" title="Customers Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/customers/case-studies/case-studies" title="Case Studies">Case Studies</a></li>
                        <li><a href="http://www.zenoss.com/customers/by-industry" title="Case Studies">Customers by Industry</a></li>
                        <li><a href="http://www.zenoss.com/customers/industries/index" title="Industries"><span>Industries</span></a></li>
       </ul>


       Partners
       <ul class="sitemap">
            <li><a href="http://www.zenoss.com/partners/open-source-network-management-solutions" title="Current Partners">Current Partners</a></li>
            <li><a href="http://www.zenoss.com/partners/contact" title="Become a Partner">Become a Partner</a></li>
       </ul>
     </td>
     <td style="padding-right:0px;">
        About Us
       <ul class="sitemap">
        <li><a href="http://www.zenoss.com/about/index" title="Overview">Overview</a></li> 
           <li><a href="http://www.zenoss.com/about/awards" title="Awards">Awards</a></li> 
           <li><a href="http://www.zenoss.com/about/team" title="Team">Team</a></li> 
           <li><a href="http://www.zenoss.com/about/news" title="News">News</a></li> 
           <li><a href="http://www.zenoss.com/about/news/events" title="Events">Events</a></li> 
           <li><a href="http://www.zenoss.com/about/jobs" title="Careers">Careers</a></li> 
           <li><a href="http://www.zenoss.com/about/contact" title="Contact">Contact</a></li>
       </ul>
     </td>
   </tr>
   <tr valign="middle">
     <td align="right">
        <a href="http://sourceforge.net/projects/zenoss" target="_blank" title="SourceForge"><img width="120" height="30" alt="Get Zenoss Core - Enterprise IT Monitoring at SourceForge.net. Fast, secure and Free Open Source software downloads" src="http://sflogo.sourceforge.net/sflogo.php?group_id=163126&amp;type=11"></a>
     </td>
     <td align="right">
        <a href="../index.html" title="Monitored by Zenoss"><img src="../themes/userbar-disabled/images/logo-monitoredby_ZEN.png" alt="Monitored By Zenoss" /></a>
     </td>
      <td colspan="3" align="right" >
        <a href="../index.html" title="Zenoss Home"><img src="../themes/userbar-disabled/images/new-logo-zenoss-footer_ZEN.gif" /></a>
       <div id="copyright" class="right">Copyright &copy; 2005-2011 Zenoss, Inc.</div>
     </td>
   </tr>
   <tr valign="top">
     <td colspan="9" align="right">&nbsp;</td>
   </tr>
 </table>
</div>
<!-- END FOOTER -->

 <!-- BEGIN SCRIPTS --> 

   <!-- END -->

    <!-- TOP NAV DROP DOWN NAVIGATION - IE6 -->
   <!-- END DROP DOWN -->       

   <!-- TWITTER SCRIPTS -->

<!-- END GOOGLE ANALYTICS CODE -->

<!-- Pardot tracking code, async version -->
<!-- END Pardot tracking code, async version -->




<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-73372470-1','auto');ga('send','pageview');</script></body>
</html>

