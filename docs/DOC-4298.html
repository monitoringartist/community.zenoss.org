<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>
        50.8 Configuring a Standalone Windows Device for a Non-Administrative Account - Open Source Network Monitoring and Systems Management
        
        
    </title>

    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="en-US" />
<meta name="keywords" content=""/>
<!-- 50.8 Configuring a Standalone Windows Device for a Non-Administrative Account -->
<meta property="og:image" content="servlet/JiveServlet/downloadImage/73-2574-13230/share-zenoss-logo.jpg" />

<link rel="search"
    href="../opensearch.xml"
    title="Zenoss Community"
    type="application/opensearchdescription+xml"/>


<link rel="shortcut icon" href="../themes/userbar-disabled/images/favicon.ico" />

    





    
      
      
     




    



    
    





    <link rel="stylesheet" href="../styles/jive-global.css" type="text/css" media="all" />
    <!-- <link rel="stylesheet" href="/styles/jive-icons-legacy.css" type="text/css" media="all" /> -->
    <link rel="stylesheet" href="../styles/jive-icons.css" type="text/css" media="all" />

    <link rel="stylesheet" href="../themes/userbar-disabled/styles/theme.css" type="text/css" media="all" />
    <link rel="stylesheet" href="../themes/userbar-disabled/styles/community.css" type="text/css" media="all" />
    <link rel="stylesheet" href="../themes/userbar-disabled/styles/sifr.css" type="text/css" media="all" />


    <!--[if IE 6]>
    <style type="text/css">
    /* hack for IE6's lack of alpha PNG support */
    * html #jive-wrapper .ie6png,
    * html #jive-wrapper #jive-global-header *.ie6png,
    * html #jive-wrapper #user-bar-wrapper *.ie6png,
    * html #jive-wrapper #jive-body *.ie6png,
    * html #jive-wrapper #jive-footer *.ie6png {
        background-image: expression(
        this.runtimeStyle.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src=" +
        (this.tagName=='IMG' ? this.src : this.currentStyle.backgroundImage.split('\"')[1]) + ")",
        this.runtimeStyle.backgroundImage = "none",
        this.src = "/images/transparent.png"
        );
        }
    </style>

    <link rel="stylesheet" href="/styles/jive-icons-ie.css" type="text/css" media="all" />
    <![endif]-->





    
    

	<link rel="stylesheet" href="../4.5.6/styles/jive-content.css" type="text/css" media="all" />

        <link rel="alternate" type="application/rss+xml"
            title="50.8 Configuring a Standalone Windows Device for a Non-Administrative Account Version History Feed"
            href="community/feeds/document-history/DOC-4298" />

        <link rel="alternate" type="application/rss+xml"
            title="50.8 Configuring a Standalone Windows Device for a Non-Administrative Account Comments Feed"
            href="community/feeds/document-comments/DOC-4298" />

    
        




    <!-- BEGIN action bar, only for non-binary documents -->

    

    <!-- END action bar -->




    <style type="text/css">/* Rating bar on documents */
.jive-content .jive-content-header .jive-content-rating {margin-bottom: 3px;}
.j-rating { padding: 0 10px; }
.jive-content-avgrating {height: 53px;}
/* END Rating bar on documents */

/* Userbar */
#jive-userbar-right {right: 50px;}
/* END Userbar */

/* Download links page */
table.download-links-table {background-color: #ffffff; width: 100%;}
table.download-links-table tbody td { text-align: center; vertical-align: middle;}
table.download-links-table thead th {text-align: center;}
table.download-links-table td, table.download-links-table th {border: 1px solid #EEEEEE !important;}

/* Provides indentation for official doc ToC items */
div.toc dl dt {margin-left: 20px;}
div.toc dl dd dl dt {margin-left: 40px;}
div.toc dl dd dl dd dl dt {margin-left: 60px;}
div.toc dl dd dl dd dl dd dl dt {margin-left: 80px;}
div.toc dl dd dl dd dl dd dl dd dl dt {margin-left: 100px;}
/* END docs items */


/* Blog posts */
div.social-button-spacer {height: 10px;}

div#social-button-cont {
margin-right:10px; 
padding:5px; 
text-align: center; 
float: right;
}

div#comment-indicator {
    float: left;
    left: 12px;
    right: inherit;
    top: 55px;
}

div#comment-indicator div.jive-reply {margin-left: 0px;}

.jive-blog-post-subject {padding-bottom: 0px;}
/* END Blog posts */


/* Community download survey */
form#core-usage-survey label.aligned {float: left; width: 120px;}
form#core-usage-survey span.required_field {color: red;}
form#core-usage-survey label.survey-small-label {display:inline;}
form#core-usage-survey div.survey-checkbox-set {width:82%;}
form#core-usage-survey div.border {border:1px solid #ACACAC; padding:5px;}

form#core-usage-survey label.survey-resource_type {font-style:italic;}
form#core-usage-survey label {
color:#333333;
display:block;
font-size:12px;
font-weight:bold;
}
/* END Community download survey */

</style>
    <style type="text/css">/* custom-css-container */</style>


</head>
<body class="jive-body-home" ><div style="width:100%;background-color:white;float:left;position:fixed;z-index:3000;top:0;right:0;border-bottom:2px solid gray;"><div style="width:1006px;font-weight:bold;margin:12px auto 12px auto;font-size:18px;"><div style="float: left; margin: 0;">Archived community.zenoss.org | full text search <form style="display: inline;" target="_blank" action="https://github.com/monitoringartist/community.zenoss.org/search" method="get"><input type="text" name="q"><input type="submit" value="Search"></form> </div><div style="float: right;"><a href="https://www.monitoringartist.com" title="Maintained by Monitoring Artist - DevOps / Docker / Kubernetes / Zabbix / Zenoss / Monitoring"><img src="assests-monitoringartist/Monitoring-Artist-logo.png" /></a></div></div></div>


<a href="DOC-4298.html#jive-body" class="jive-skip-nav">Skip navigation</a>

    <div id="jive-compliance" class=""style="display:none">
        <span class="jive-icon-med "></span>
        
    </div>

    <div id="jive-wrapper" class="clearfix">

    <!-- Load search for guests -->

    <div id="jive-userbar-search">
    <form action="search.jspa" method="get" id="jive-userbar-search-form">
        <input type="hidden" name="peopleEnabled" value="true"/>

        <input type="hidden" name="userID"/>
        <input type="hidden" name="containerType"/>
        <input type="hidden" name="container"/>
        <input type="hidden" name="spotlight" value="false"/>
        <label for="jive-query"
               class="j-508-label">Search for:</label>
        <input type="text" id="jive-query" name="q" value="" accesskey="4" class="searchbar jive-userbar-search-field"
               autocomplete="off"/>
    </form>

    <div id="jive-spotlight-search-container"></div>
</div>

    <!-- END anon search -->

<!-- SKIP NAV FOR ACCESSIBILITY -->
<a href="DOC-4298.html#skipnav"></a>
<!-- END -->

<div id="header">

    <!-- START TOP NAVIGATION -->
    <div id="navcontainer">
        <table cellpadding="0" cellspacing="0" width="100%" border="0">
          <tr valign="bottom">
            <td rowspan="2">
                <a href="../index.html" title="Zenoss Open Source IT Management"><img src="../themes/userbar-disabled/images/zenoss-logo-reversed-web.png" style="width:254px; margin: 0 0px 25px;" alt="Zenoss Open Enterprise Management" /></a>
            </td>
            <td height="45" colspan="2">
                <div id="zenoss-panel">
                    <div style="width: 200px;" id="cpanel-lt"></div>
                    <ul id="subnav-rt" class="png_fix">
                        <li><a href="http://www.zenoss.com/" title="Zenoss.Inc Home" class="none">Zenoss, Inc.</a></li>
                        <!--<li><a href="/community/feedback" title="Feedback" class="none">Feedback</a></li>-->
                        <!--<li><a href="http://www.zenoss.com/support" title="Support" class="none">Support</a></li>-->
                    </ul>
                </div>
            </td>
          </tr>
          <tr valign="middle">
            <td colspan="2" height="80">
                <ul id="navlist">
                    <li><a href="community/documentation" title="DOCS" class="nav1"><span>DOCS</span></a></li>
                    <li><a href="community/forums" title="FORUMS" class="nav2"><span>FORUMS</span></a></li>        
                    <!--<li><a href="/community/zenpacks" title="ZENPACKS" class="nav3"><span>ZENPACKS</span></a></li>-->
                    <li><a href="http://wiki.zenoss.org/Category:ZenPacks" title="ZENPACKS" class="nav3"><span>ZENPACKS</span></a></li>        
                    <li><a href="community/partners" title="PARTNERS" class="nav4"><span>PARTNERS</span></a></li>      
                    <li><a href="community/about" title="ABOUT" class="nav4"><span>ABOUT</span></a></li>   
                    <li><a href="../blogs/zenossblog.html" title="BLOG" class="nav5"><span>BLOG</span></a></li>
                    <li><a href="community/testing" title="TESTING" class="nav5"><span>TESTING</span></a></li> 
                    <li><a href="community/developers" title="DEVELOPERS" class="nav6"><span>DEVELOPMENT</span></a></li>
                    <li><a href="../community/download.html" title="DOWNLOADS" class="nav7 png_fix"><span>DOWNLOAD</span></a></li>
                </ul>
            </td>
          </tr>
        </table>
    </div>
    <!-- END TOP NAV -->

</div>

<!-- START MID COL -->
<div id="middle">

    <!-- SKIPNAV ADDED FOR ACCESSIBILITY -->
    <a name="skipnav"></a>
    <!-- SKIPNAV END -->
        
      <!-- START CONTENT -->
      
        <!-- MAIN CONTENT START -->
        <!-- CHANGE CLASS ACCORDING TO SUB SECTION FOR PROPER TOP BANNER -->


        <div id="subcontent">




<!-- BEGIN user bar -->
<div id="user-bar-wrapper">
    <div id="jive-userbar">
<div id="jive-userbar-login">
    <form action="https://community.zenoss.org/cs_login"
          method="post" name="loginform" autocomplete="off">
        
        

        <span class="jive-userbar-login-welcome" id="jiveLoginWelcome">
            <span class="jive-userbar-login-guest">
            Welcome, Guest
            </span>

            <span class="jive-userbar-login-loginlink">
                <a href="DOC-4298.html#" onClick="jivetoggleLogin(); return false;">Login</a>
            </span>

            <span class="jive-userbar-login-new">
                <a href="../login!input.jspa%3FregisterOnly=true.html">Register</a>
            </span>
        </span>

        <span class="jive-userbar-login-form" id="jiveLoginForm" style="display: none;">

            <span class="jive-userbar-login-username">
                <label for="login-username">
Username:                </label>
                <a href="docs/forgot-username!input.jspa" title="I forgot my username ">(?)</a>
                <input type="text" name="username" size="20" maxlength="150" value="" tabindex="1"
                               id="login-username" />
            </span>

            <span class="jive-userbar-login-password">
                <label for="login-password">
Password:                </label>
                <a href="docs/emailPasswordToken!input.jspa" title="I forgot my password ">(?)</a>
                <input type="password" name="password" size="20" maxlength="150" value="" tabindex="2"
                               id="login-password" />
            </span>

            <span class="jive-userbar-login-auto">
                <input type="checkbox" name="autoLogin" id="login-auto" value="true" tabindex="3" />
                <label for="login-auto">Remember Me</label>
            </span>

            <span class="jive-userbar-login-submit">
                <input type="submit" name="login" value="Login" tabindex="4"
                       class="jive-login-button" />
                <input type="reset" name="doCancel" value="Cancel" tabindex="5"
                               class="jive-cancel-button" onclick="jivetoggleLogin();" />
            </span>
        </span>

    </form>
</div>        <div id="jive-userbar-right">

    <div id="jive-userbar-search">
    <form action="search.jspa" method="get" id="jive-userbar-search-form">
        <input type="hidden" name="peopleEnabled" value="true"/>

        <input type="hidden" name="userID"/>
        <input type="hidden" name="containerType"/>
        <input type="hidden" name="container"/>
        <input type="hidden" name="spotlight" value="false"/>
        <label for="jive-query"
               class="j-508-label">Search for:</label>
        <input type="text" id="jive-query" name="q" value="" accesskey="4" class="searchbar jive-userbar-search-field"
               autocomplete="off"/>
    </form>

    <div id="jive-spotlight-search-container"></div>
</div>

        </div>
    </div>

</div>
<!-- END user bar -->

            <div id="jive-body">

<!-- BEGIN breadcrumb -->
<div id="jive-breadcrumb">

    <span>
                <a href="../index.jspa.html">
            Zenoss Community</a> &gt; 
                <a href="community/documentation">
            Documentation</a> &gt; 
                <a href="community/documentation/official_documentation">
            Zenoss Core Product Documentation</a> &gt; 
                <a href="community/documentation/official_documentation/zenoss-extended-monitoring">
            Zenoss Extended Monitoring</a> &gt; 
                <a href="../community/documentation/official_documentation/zenoss-extended-monitoring/2.5.0">
            2.5.0</a> &gt; 

        <a class='jive-breadcrumb-last' href="../community/documentation/official_documentation/zenoss-extended-monitoring/2.5.0%3Fview=documents">Documents</a></span>
</div>
<!-- END breadcrumb -->

            

    <form id="documentRestoreForm" method="post" action='docs/DOC-4298/restore'>
        <input type="hidden" name="version" value="2" />
        <input type="hidden" name="jive.token.name" value="document.restore.DOC-4298"/>
        <input type="hidden" name="document.restore.DOC-4298" value="1394831238758-FSCOB5N4ZYEVEOHEXQLJQ2SGZUODAASW"/>
    </form>

    <form id="documentDeleteForm" method="post" action='docs/DOC-4298/delete'>
        <input type="hidden" name="jive.token.name" value="document.delete.DOC-4298"/>
        <input type="hidden" name="document.delete.DOC-4298" value="1394831238763-I35IGBX6LWHX2UVO2H4I8BYAT64YE8RV"/>
    </form>

    <form id="documentPublishForm" method="post" action='doc-publish.jspa'>
        <input type="hidden" name="jive.token.name" value="document.publish.DOC-4298"/>
        <input type="hidden" name="document.publish.DOC-4298" value="1394831238769-KKVVI2INCI0YM36GG7NOJ4A7KZWMQSQC"/>
        <input type="hidden" name="document" value="DOC-4298" />
    </form>


    <!-- BEGIN header & intro  -->
    <div id="jive-body-intro">
        <div id="jive-body-intro-content">
            
            <a href="../community/documentation/official_documentation/zenoss-extended-monitoring/2.5.0%3Fview=documents"><span class="jive-icon-sml jive-icon-arrow-generic-up"></span>
                    Up to Documents in 2.5.0
            </a>

        </div>
    </div>
    <!-- END header & intro -->

    <!-- BEGIN main body -->
    <div id="jive-body-main">

        <!-- BEGIN main body column -->
        <div id="jive-body-maincol-container">

            <div id="jive-body-maincol">


                <div id="thread.watch.notify" class="jive-info-box" style="display:none"></div>

                <div id="content-featured-notify" class="jive-info-box" style="display:none"></div>








<!-- BEGIN document -->
<div class="jive-content clearfix">
    <div class="jive-content-header clearfix">
        <div class="jive-wiki-post-moderating jive-content-header-moderating">
            <span class="jive-icon-med jive-icon-moderation"></span>Currently Being Moderated
        </div>
        <div class="jive-content-title">
            <h2><span class="jive-icon-big jive-icon-document"></span>50.8 Configuring a Standalone Windows Device for a Non-Administrative Account</h2>
        </div>
        <div class="jive-content-header-version">
            VERSION 2&nbsp;
                <a href="docs/DOC-4298/diff?secondVersionNumber=2" title="Click to view document history"><img class="jive-icon-sml jive-icon-search" src="../4.5.6/images/transparent.png" alt="Click to view document history" /></a>


        </div>
        <div class="jive-content-header-details">

Created on: Oct 26, 2009 4:29 PM by
<a href="../people/zenoss_api.html"
data-externalId=""
data-username="zenoss_api"
data-avatarId="-1"
id="jive-692632882641847588446"
onmouseover="var presence = null; quickuserprofile.getUserProfileTooltip( 6926, presence );"
onmouseout="quickuserprofile.cancelTooltip();"
class="jiveTT-hover-user jive-username-link"
>Zenoss API</a>            <span>-</span>
Last Modified:&nbsp;
Oct 27, 2009 9:29 AM
by <a href="../people/jhamilton.html"
data-externalId=""
data-username="jhamilton"
data-avatarId="1024"
id="jive-541932882641848156867"
onmouseover="var presence = null; quickuserprofile.getUserProfileTooltip( 5419, presence );"
onmouseout="quickuserprofile.cancelTooltip();"
class="jiveTT-hover-user jive-username-link"
>John Hamilton</a>        </div>

        <div class="jive-content-rating clearfix" data-guid="3LZV6EELZ5YBFVEOOEC9KP3C3SAE4086">

<script type='text/javascript'>
    $j(document).ready(function() {

        var i18n = {
            avgUserRatingTitlei18n : "Average User Rating",
            avgUserRatingLabeli18n : "Average User Rating",
            rateRatingLabel : "rating",
            myRatingLabel : "My Rating:",
            rateRatingsLabel : "ratings",
            ratingSavingText : "Saving...",
            rateSavedText : "Saved.",
            rateRatingSaved : "Rating Saved!",
            writeAReview : "Write a review",
            commentOnRating : "Comment on your rating",
            formSubmitPleaseWait:'Please Wait ...'
        };

        new jive.Rate(14, 2217, 102, 4298, 'doc', i18n, true, '3LZV6EELZ5YBFVEOOEC9KP3C3SAE4086');
    });

</script>

        </div>
    </div>

    <div class="jive-content-body">


<!-- [DocumentBodyStart:d94966e0-0d50-415a-b9a9-8a8336d4eb45] --><div class="jive-rendered-content"><div class="navheader"><table summary="Navigation header" width="100%"><tbody><tr><th align="center" colspan="3" style=";">8. Configuring a Standalone Windows Device for a Non-Administrative Account</th></tr><tr><td align="left" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-extended-monitoring/2.5.0/ch50s07.html">Prev</a> </td><th align="center" style=";" width="60%">Chapter 50. Windows Performance</th><td align="right" style=";" width="20%"> <a class="jive-link-external-small" href="zenoss-extended-monitoring/2.5.0/ch50s09.html">Next</a></td></tr></tbody></table><hr/></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both;"><a class="jive-link-anchor-small" name="zenwinperf_non_admin_account">#</a>8. Configuring a Standalone Windows Device for a Non-Administrative Account</h2></div></div></div><p>Monitoring Windows devices normally requires an account with Administrator level privileges. For the Zenoss user that wishes to use a non-administrative account several additional configuration steps must be performed on each Windows device, or by using a Group Policy.</p><p>Zenoss uses the Windows Management Instrumentation (WMI) feature to collect Event Log and Service information in the Core edition and modeling information when using the Enterprise edition. In the Enterprise edition, the remote Windows registry API is also used to collect low-level performance monitor ("PerfMon") statistics. Both of these Windows subsystems use the Microsoft Remote Procedure Call (MS-RPC) interface to connect to the Windows device and gather the appropriate information. MS-RPC handles the authentication on a per packet or per session basis, but ultimately the access granted is determined by the subsystems involved with serving the remote procedure calls.</p><div class="orderedlist"><ol type="1"><li><p>If the Windows Firewall is in use, modify it to allow Remote Administration access. This will open the MS-RPC port and others as needed. The following command entered in a Command Prompt can be used:</p><pre class="screen">netsh firewall set service RemoteAdmin enable</pre></li><li><p>On Windows XP, Simple File Sharing must be disabled for machines that are not located within a Domain. When this feature is enabled it causes all incoming MS-RPC connections to use the built-in Guest account, rather than the account credentials specified in the incoming call. This option may be found by going to <span class="guilabel">Control Panel</span>, opening the Folder Options applet and then choosing the <span class="guilabel">View</span> tab. In the <span class="guilabel">Advanced Settings</span> list, navigate to the bottom until you see the <span class="guilabel">Use simple file sharing (Recommended)</span> option and then disable it.</p><div class="figure"><a class="jive-link-anchor-small" name="d4e8544">#</a><p class="title"><strong>Figure 50.1. Windows XP Disable Simple File Sharing</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" cellpadding="0" cellspacing="0" style="width: 360px;" summary="manufactured viewport for HTML img"><tbody><tr><td style="border:0px solid black;"><a href="servlet/JiveServlet/showImage/102-4298-2-1621/winXP-disable-simple-file-sharing.png"><img alt="winXP-disable-simple-file-sharing.png" class="jive-image" height="337" src="servlet/JiveServlet/downloadImage/102-4298-2-1621/450-337/winXP-disable-simple-file-sharing.png" width="450"/></a></td></tr></tbody></table></div></div></div><br class="figure-break"/></li><li><p>Create a new local account on the Windows device for monitoring. We assume in the remainder of these steps that this account was named <code class="literal">zenossmon</code> but any valid account name can be used. Place the account only in the Users group and not in the Power Users or Administrators groups. Optionally, create a new user group for monitoring and use that group instead of the account in the remaining steps.</p></li><li><p>Give the <code class="literal">zenossmon</code> account DCOM access by running the <a class="jive-link-external-small" href="http://msdn.microsoft.com/en-us/library/aa393266.aspx"><span class="command"><strong>dcomcnfg</strong></span> utility</a>.</p><div class="figure"><a class="jive-link-anchor-small" name="d4e8557">#</a><p class="title"><strong>Figure 50.2. Component Services COM Security Settings</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" cellpadding="0" cellspacing="0" style="width: 360px;" summary="manufactured viewport for HTML img"><tbody><tr><td style="border:0px solid black;"><a href="servlet/JiveServlet/showImage/102-4298-2-1625/component-services-com-security.png"><img alt="component-services-com-security.png" class="jive-image" height="310" src="servlet/JiveServlet/downloadImage/102-4298-2-1625/450-310/component-services-com-security.png" width="450"/></a></td></tr></tbody></table></div></div></div><br class="figure-break"/><div class="orderedlist"><ol type="a"><li><p>In the <span class="guilabel">Component Services</span> dialog box, expand <span class="guilabel">Component Services</span>, expand <span class="guilabel">Computers</span>, and then right-click <span class="guilabel">My Computer</span> and click <span class="guilabel">Properties</span> .</p></li><li><p>In the <span class="guilabel">My Computer Properties</span> dialog box, click the <span class="guilabel">COM Security</span> tab.</p></li><li><p>Under <span class="guilabel">Access Permissions</span>, click <span class="guilabel">Edit Limits</span>. In the <span class="guilabel">Access Permission</span> dialog box, add the <code class="literal">zenossmon</code> account to the list and ensure that the <span class="guilabel">Remote Access</span> checkbox is enabled, then click <span class="guibutton">OK</span> to close the dialog.</p></li><li><p>Under <span class="guilabel">Launch and Activation Permissions</span>, click <span class="guilabel">Edit Limits</span>. In the <span class="guilabel">Access Permission</span> dialog box, add the <code class="literal">zenossmon</code> account to the list and ensure that the <span class="guilabel">Remote Launch</span> and <span class="guilabel">Remote Activation</span> checkboxes are enabled, then click <span class="guibutton">OK</span> to close the dialog.</p></li><li><p>Click <span class="guibutton">OK</span> on the <span class="guilabel">My Computer Properties</span> dialog to save all changes.</p></li></ol></div></li><li><p>Give the <code class="literal">zenossmon</code> account permissions to read the WMI namespace by using <a class="jive-link-external-small" href="http://technet.microsoft.com/en-us/library/cc787533.aspx"><span class="guilabel">WMI Control</span></a>.</p><div class="figure"><a class="jive-link-anchor-small" name="d4e8600">#</a><p class="title"><strong>Figure 50.3. WMI Control Properties</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" cellpadding="0" cellspacing="0" style="width: 360px;" summary="manufactured viewport for HTML img"><tbody><tr><td style="border:0px solid black;"><a href="servlet/JiveServlet/showImage/102-4298-2-1626/wmi-control-properties.png"><img alt="wmi-control-properties.png" class="jive-image" height="407" src="servlet/JiveServlet/downloadImage/102-4298-2-1626/450-407/wmi-control-properties.png" width="450"/></a></td></tr></tbody></table></div></div></div><br class="figure-break"/><div class="orderedlist"><ol type="a"><li><p>Open the <span class="guimenu">Start</span> menu and right-click on <span class="guilabel">My Computer</span>. Select <span class="guimenuitem">Manage</span> from the menu.</p></li><li><p>In the <span class="guilabel">Computer Management</span> dialog, expand the <span class="guilabel">Services and Applications</span> item and then right-click on <span class="guilabel">WMI Control</span>.</p></li><li><p>In the <span class="guilabel">WMI Control Properties</span> dialog, click the <span class="guilabel">Security</span> tab.</p></li><li><p>Expand the <span class="guilabel">Root</span> namespace, select the <span class="guilabel">CIMV2</span> namespace folder and then click <span class="guilabel">Security</span>.</p></li><li><p>In the <span class="guilabel">Security for ROOT\CIMV2</span> dialog, add the <code class="literal">zenossmon</code> user to the list and ensure the <span class="guilabel">Enable Account</span> and <span class="guilabel">Remote Enable</span> checkboxes are enabled, then click <span class="guibutton">OK</span> to close the dialog.</p></li><li><p>In the <span class="guilabel">WMI Control Properties</span> dialog click <span class="guibutton">OK</span> to close the dialog and save all changes.</p></li></ol></div></li><li><p>At this point in the process remote access to WMI should be enabled and functioning. Test it by running the following command from the Zenoss server:</p><pre class="screen">wmic -U '.\zenossmon' //<em class="replaceable"><code>myhostname</code></em> 'SELECT Name FROM Win32_ComputerSystem'</pre><p>If all is well this command should return the remote system name as the response. If there is any error, carefully recheck the above steps to ensure all access has been properly granted.</p></li><li><p>To gather Windows performance data from PerfMon permissions on the <code class="literal">winreg</code> registry key must be granted to our monitoring user by using <a class="jive-link-external-small" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;164018"><span class="command"><strong>regedit</strong></span></a>.</p><div class="figure"><a class="jive-link-anchor-small" name="d4e8646">#</a><p class="title"><strong>Figure 50.4. regedit and the winreg Key</strong></p><div class="figure-contents"><div class="mediaobject"><table border="0" cellpadding="0" cellspacing="0" style="width: 360px;" summary="manufactured viewport for HTML img"><tbody><tr><td style="border:0px solid black;"><a href="servlet/JiveServlet/showImage/102-4298-2-1627/regedit-and-winreg.png"><img alt="regedit-and-winreg.png" class="jive-image" height="448" src="servlet/JiveServlet/downloadImage/102-4298-2-1627/450-448/regedit-and-winreg.png" width="450"/></a></td></tr></tbody></table></div></div></div><br class="figure-break"/><div class="orderedlist"><ol type="a"><li><p>Run <span class="command"><strong>regedit</strong></span>.</p></li><li><p>Browse to the <code class="filename">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg</code> key.</p></li><li><p>Right-click on the <code class="literal">winreg</code> key and choose <span class="guilabel">Permissions</span>.</p></li><li><p>Add the monitoring user to the permissions list and grant only <code class="literal">Read</code> permissions</p></li></ol></div></li><li><p>Give the <code class="literal">zenossmon</code> account <a class="jive-link-external-small" href="http://support.microsoft.com/kb/323076">access to read the Windows Event Log</a>.</p><p>Once the appropriate changes are made, test that Event Log access works with your <code class="literal">zenossmon</code> user by running the following from your Zenoss system:</p><pre class="screen">wmic -U '.\zenossmon' //<em class="replaceable"><code>myhostname</code></em> \<br/>'SELECT Message FROM Win32_NTLogEvent WHERE LogFile="Application"'</pre></li><li><p>If you are using SP1 or newer with Windows Server 2003, then you will need to <a class="jive-link-external-small" href="http://support.microsoft.com/kb/907460">allow non-administrative users to access the service control manager</a> in order to monitor services.</p><p>At a command prompt, run the following:</p><pre class="screen">sc sdset SCMANAGER<br/>D:(A;;CCLCRPRC;;;AU)(A;;CCLCRPWPRC;;;SY)(A;;KA;;;BA)S:(AU;FA;KA;;;WD)<br/>(AU;OIIOFA;GA;;;WD)</pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>The above command should be one line.</p></div><p>At this point you should be able to query Windows service status remotely using the non-administrative account. This can be tested by running the following from your Zenoss system:</p><pre class="screen">wmic -U '.\zenossmon' //<em class="replaceable"><code>myhostname</code></em> 'SELECT Name FROM Win32_Service'</pre></li></ol></div></div><div class="navfooter"><hr/><table summary="Navigation footer" width="100%"><tbody><tr><td align="left" style=";" width="40%"><a class="jive-link-external-small" href="zenoss-extended-monitoring/2.5.0/ch50s07.html">Prev</a> </td><td align="center" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-extended-monitoring/2.5.0/ch50.html">Up</a></td><td align="right" style=";" width="40%"> <a class="jive-link-external-small" href="zenoss-extended-monitoring/2.5.0/ch50s09.html">Next</a></td></tr><tr><td align="left" style=";" valign="top" width="40%">7. Modify Registry Settings for Firewalls in Secure Environments </td><td align="center" style=";" width="20%"><a class="jive-link-external-small" href="zenoss-extended-monitoring/2.5.0/index.html">Home</a></td><td align="right" style=";" valign="top" width="40%"> 9. Tuning Collector Daemon Performance</td></tr></tbody></table></div></div><!-- [DocumentBodyEnd:d94966e0-0d50-415a-b9a9-8a8336d4eb45] -->

<!-- BEGIN attachments -->
<!-- END attachments -->
    </div>
    <div class="jive-content-footer clearfix">


    <!-- BEGIN content details -->
        <span class="jive-content-footer-item jive-content-footer-acclaim">

<div id="acclaim-container-102-4298-" class="acclaim-container">
    <div id="jive-acclaim-like-container-102-4298-" data-uniqueKey="102-4298-" data-ratingType="like" data-hasVoted="false" data-likes="0" class="acclaim-like-container">
         <span class="jive-icon-sml jive-icon-like"></span>Like
         (<a href="DOC-4298.html#" id="jive-acclaim-likedlink-102-4298-"  class=" jive-acclaim-likedlink">0</a>)
    </div>
</div>        </span>

     
        <span class="jive-content-footer-item">
            32395&nbsp;Views
        </span>

        



    <!-- BEGIN view/add/edit tags -->
    <span class="jive-content-footer-item jive-content-footer-tags">
    </span>
    <!-- END view/add/edit tags -->
<!-- END content -->

    </div>
</div>
<!-- END document -->





    
    <script>
    </script>






    <link rel="stylesheet" type="text/css" href="../4.5.6/styles/tiny_mce3/plugins/inlinepopups/skins/clearlooks2/window.css" />




    




        <a name="comments"></a>

        <!-- BEGIN tabs -->
        <div class="jive-body-tabbar">

                <span id="jive-comments-tab" class="jive-body-tab jive-body-tabcurrent">
                    <strong class="font-color-normal">
                        Comments (<span id="jive-comments-count">0</span>)
                    </strong>
                </span>

        </div>
        <!-- END tabs -->

            <div class="jive-box clearfix" id="jive-comments" ></div>

        <div style="display:none;" id="jive-comment-post-block">
            <form method="post" action="javascript:void(0);" name="jive-comment-post-form">

                <p class="jive-error-text" id="jive-comment-error" style="display:none"></p>

                    <div class="jive-comment-post-anonymous">
                        <div>
                            <input id="comment-author" name="commentGuestName" />
                            <label for="comment-author">Name</label>
                        </div>
                        <div>
                            <input id="comment-email" name="commentGuestEmail"  />
                            <label for="comment-email">Email Address</label>
                        </div>
                        <div>
                            <input id="comment-url" name="commentGuestUrl" />
                            <label for="comment-url">Website Address</label>
                        </div>
                    </div>

                <div>
                    <textarea name="commentBody" id="wysiwygtext" rows="10" class="jive-comment-textarea"></textarea>
                </div>

                <div style="display:none;" id="jive-blog-comment-preview" class="jive-blog-comment-preview"></div>


                <div class="jive-form-buttons">
                    <input type="submit" name="post" value="Add Comment" />
                    <input type="button" name="cancel" value="Cancel" />
                </div>

            </form>
        </div>

        <div style="display:none;"  id="jive-comment-edit-block">
            <form method="post" action="javascript:void(0);" name="jive-comment-edit-form">
                <p class="jive-error-text" id="jive-comment-error" style="display:none"></p>
                <div class="jive-comment-post-anonymous">
                    <div>
                        <input name="name" value="" />
                        <label for="name">Name
                            <span>(required)</span></label>
                    </div>
                    <div>
                        <input name="email" value="" />
                        <label for="email">Email Address
                            <span>(required, will not be published)</span></label>
                    </div>
                    <div>
                        <input name="url" value=""/>
                        <label for="url">Website Address</label>
                    </div>
                </div>
                <div>
                    <textarea name="commentBody" id="wysiwygtext" rows="10" class="jive-comment-textarea"><%= commentBody %></textarea>
                </div>

                <div style="display:none;" id="jive-blog-comment-preview" class="jive-blog-comment-preview"></div>

                <div class="jive-form-buttons">
                    <input type="button" name="post" value="Save" />
                    <input type="button" name="cancel" value="Cancel" />
                </div>

            </form>
        </div>




            </div>
        </div>
        <!-- END main body column -->


        <!-- BEGIN sidebar column -->
        <div id="jive-body-sidebarcol-container">

            <div id="jive-body-sidebarcol">


<div id="jive-action-sidebar" class="jive-sidebar jive-box jive-sidebar-actions jive-box-actions">


    <div class="jive-box-header">
        <h4 id="jive-action-sidebar-tab-header_document-actions-tab">Actions</h4>
    </div>
    <div id="jive-action-sidebar-body" class="jive-sidebar-body jive-sidebar-body-actions jive-box-body">

        <div id="jive-action-sidebar-tab-_document-actions-tab"
             class="jive-action-sidebar-tab-first"
 >



            <ul id="jive-action-sidebar-tab-list_document-actions-tab" class=" jive-icon-list">
















                <li id="jive-link-thread-print" style=""
                        ><a href="DOC-4298%3Fdecorator=print.html"
rel="nofollow"
onclick=""
title="">
<span class="jive-icon-med jive-icon-print-preview"></span>
View print preview
</a></li>



            </ul>
        </div> <!-- /#jive-action-sidebar-tab-_id -->
    </div>

</div>




    <!-- BEGIN sidebar box 'More Like This' -->

    <div class="jive-box jive-sidebar">
        <div class="jive-box-header jive-sidebar-header">
            <h4>More Like This</h4>
        </div>
        <div class="jive-box-body jive-sidebar-body jive-sidebar-body-morelikethis">
            <ul class="jive-icon-list" id="jive-more-like-this-102-4298">
                <li><span>Retrieving data ...</span></li>
            </ul>
        </div>
    </div>

    <!-- END sidebar box 'More Like This' -->

    
    

        
        
        
        
        

<!-- BEGIN sidebar box 'User Content' -->
<div class="jive-box jive-sidebar">
    <div class="jive-box-header jive-sidebar-header">
        <h4>More by Zenoss API</h4>
    </div>
    <div class="jive-box-body jive-sidebar-body jive-sidebar-body-usercontent">
        <ul class="jive-icon-list">
                    <li>
                        <a href="DOC-4081.html"
                        ><span class="jive-icon-med jive-icon-document"></span>18.1 AIX</a>
                    </li>
                    <li>
                        <a href="DOC-4134.html"
                        ><span class="jive-icon-med jive-icon-document"></span>24.5 5 Extended Capabilities for Cisco Devices</a>
                    </li>
                    <li>
                        <a href="DOC-4145.html"
                        ><span class="jive-icon-med jive-icon-document"></span>26.7 7 Deploying Hubs</a>
                    </li>
                    <li>
                        <a href="DOC-4332.html"
                        ><span class="jive-icon-med jive-icon-document"></span>52.5 5 Viewing Guest Virtual Machines</a>
                    </li>
                    <li>
                        <a href="DOC-4320.html"
                        ><span class="jive-icon-med jive-icon-document"></span>52.1 1 About</a>
                    </li>
        </ul>
        <div class="jive-sidebar-viewall">
            <a href="../people/zenoss_api.html" class="font-color-meta j-link-viewall"><strong>View Zenoss API's profile</strong></a>
        </div>
    </div>
</div>
<!-- END sidebar box 'User Content' -->


            </div>

        </div>
        <!-- END sidebar column -->


    </div>



        </div>

<div class="clear"></div>
        </div>
        <!-- MAIN CONTENT END -->
     <!-- END CONTENT -->

</div>
<!-- END MIDDLE CONTENT -->

<!-- START FOOTER -->
<div id="footer">
 <table cellpadding="0" cellspacing="0" border="0">
   <tr valign="top">
      <td rowspan="2" style="padding-left:10px;padding-right:10px;">
        <ul id="socialmedia">
        <li><a href="http://feeds.feedburner.com/ZenossBlog" class="rss" target="_blank"><span>rss</span></a></li>
           <li><a href="http://twitter.com/zenoss" class="twitter" target="_blank"><span>twitter</span></a></li>
           <li><a href="http://slashdot.org/bookmark.pl" class="slashdot" target="_blank"><span>slashdot</span></a></li>
           <li><a href="http://www.reddit.com/" class="reddit" target="_blank"><span>reddit</span></a></li>
           <li><a href="http://delicious.com/save" class="del" target="_blank"><span>delicious</span></a></li>
           <li><a href="http://technorati.com/" class="tech" target="_blank"><span>technorati</span></a></li>
       </ul> 
     </td>
     <td rowspan="2" style="padding-left:10px;padding-right:10px;">
        <a href="http://twitter.com/zenoss" title="Follow us on Twitter">Follow Us On Twitter &raquo;</a>
       <ul id="twitter_update_list"> </ul>
     </td>
     <td rowspan="2" style="padding-right:10px;">
        <a href="../blogs/zenossblog.html" title="Latest from the Zenoss blog">Latest from the Zenoss Blog &raquo;</a>
       <script language="JavaScript" src="http://feed2js.org//feed2js.php?src=http%3A%2F%2Ffeeds.feedburner.com%2FZenossBlog%3Fformat%3Dxml&amp;num=3&amp;desc=85&amp;targ=y" type="text/javascript"></script>
       <noscript><a href="http://feed2js.org//feed2js.php?src=http%3A%2F%2Ffeeds.feedburner.com%2FZenossBlog%3Fformat%3Dxml&amp;num=3&amp;desc=85&amp;targ=y&amp;html=y">View RSS feed</a></noscript>
     </td>
     <td rowspan="2" valign="middle" style="padding-right:20px;">
        <img src="../themes/userbar-disabled/images/tableborder.png" alt="" />
     </td>
     <td>
        Community
       <ul class="sitemap">
        <li><a href="../index.jspa.html" title="Home">Home</a></li>
           <li><a href="community/documentation" title="Documentation">Documentation</a></li>
           <li><a href="community/developers" title="Code">Code</a></li> 
           <li><a href="community/zenpacks" title="ZenPacks">ZenPacks</a></li> 
           <li><a href="community/forums" title="Discussion">Discussion</a></li> 
           <li><a href="community/partners" title="Get Involved">Get Involved</a></li> 
           <li><a href="../people.1.html" title="Membership">Membership</a></li>
       </ul>
     </td>
     <td>
        Products
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/solution/overview" title="Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/solution/virtualization-monitoring" title="Virtualization Monitoring">Virtualization Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/cloud-monitoring" title="Cloud Monitoring">Cloud Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/cisco-ucs-management" title="Cisco UCS Management">Cisco UCS Management</a></li>
                        <li><a href="http://www.zenoss.com/solution/server-monitoring" title="Server Monitoring">Server Monitoring</a></li>
                        <li><a href="http://www.zenoss.com/solution/network" title="Network Monitoring">Network Monitoring</a></li>
       </ul>
     </td>
     <td>
        Services
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/support/index" title="Support Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/support/consulting" title="Consulting">Consulting</a></li>
                        <li><a href="http://www.zenoss.com/support/customer-support" title="Support">Customer Support</a></li>
                        <li><a href="http://www.zenoss.com/support/training" title="Training">Training</a></li>        
       </ul>
       Resources
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/resources/demo" title="Resources">Resource Center</a></li>
       </ul>
     </td>
     <td>
       Customers
       <ul class="sitemap">
                        <li><a href="http://www.zenoss.com/customers/index" title="Customers Overview">Overview</a></li>
                        <li><a href="http://www.zenoss.com/customers/case-studies/case-studies" title="Case Studies">Case Studies</a></li>
                        <li><a href="http://www.zenoss.com/customers/by-industry" title="Case Studies">Customers by Industry</a></li>
                        <li><a href="http://www.zenoss.com/customers/industries/index" title="Industries"><span>Industries</span></a></li>
       </ul>


       Partners
       <ul class="sitemap">
            <li><a href="http://www.zenoss.com/partners/open-source-network-management-solutions" title="Current Partners">Current Partners</a></li>
            <li><a href="http://www.zenoss.com/partners/contact" title="Become a Partner">Become a Partner</a></li>
       </ul>
     </td>
     <td style="padding-right:0px;">
        About Us
       <ul class="sitemap">
        <li><a href="http://www.zenoss.com/about/index" title="Overview">Overview</a></li> 
           <li><a href="http://www.zenoss.com/about/awards" title="Awards">Awards</a></li> 
           <li><a href="http://www.zenoss.com/about/team" title="Team">Team</a></li> 
           <li><a href="http://www.zenoss.com/about/news" title="News">News</a></li> 
           <li><a href="http://www.zenoss.com/about/news/events" title="Events">Events</a></li> 
           <li><a href="http://www.zenoss.com/about/jobs" title="Careers">Careers</a></li> 
           <li><a href="http://www.zenoss.com/about/contact" title="Contact">Contact</a></li>
       </ul>
     </td>
   </tr>
   <tr valign="middle">
     <td align="right">
        <a href="http://sourceforge.net/projects/zenoss" target="_blank" title="SourceForge"><img width="120" height="30" alt="Get Zenoss Core - Enterprise IT Monitoring at SourceForge.net. Fast, secure and Free Open Source software downloads" src="http://sflogo.sourceforge.net/sflogo.php?group_id=163126&amp;type=11"></a>
     </td>
     <td align="right">
        <a href="../index.html" title="Monitored by Zenoss"><img src="../themes/userbar-disabled/images/logo-monitoredby_ZEN.png" alt="Monitored By Zenoss" /></a>
     </td>
      <td colspan="3" align="right" >
        <a href="../index.html" title="Zenoss Home"><img src="../themes/userbar-disabled/images/new-logo-zenoss-footer_ZEN.gif" /></a>
       <div id="copyright" class="right">Copyright &copy; 2005-2011 Zenoss, Inc.</div>
     </td>
   </tr>
   <tr valign="top">
     <td colspan="9" align="right">&nbsp;</td>
   </tr>
 </table>
</div>
<!-- END FOOTER -->

 <!-- BEGIN SCRIPTS --> 

   <!-- END -->

    <!-- TOP NAV DROP DOWN NAVIGATION - IE6 -->
   <!-- END DROP DOWN -->       

   <!-- TWITTER SCRIPTS -->

<!-- END GOOGLE ANALYTICS CODE -->

<!-- Pardot tracking code, async version -->
<!-- END Pardot tracking code, async version -->




<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-73372470-1','auto');ga('send','pageview');</script></body>
</html>

